<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="twitter:image" content="https://qweasd147.github.io"/><meta data-react-helmet="true" name="twitter:description" content="IntelliJ에서 Async Profiler(IntelliJ Profiler)를 통한 성능 측정"/><meta data-react-helmet="true" name="twitter:title" content="IntelliJ Async Profiler - Blog by joohyung"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" property="og:image" content="https://qweasd147.github.io"/><meta data-react-helmet="true" property="og:site_name" content="IntelliJ Async Profiler - Blog by joohyung"/><meta data-react-helmet="true" name="description" content="IntelliJ에서 Async Profiler(IntelliJ Profiler)를 통한 성능 측정"/><meta name="theme-color" content="hsl(31, 92%, 62%)"/><meta name="generator" content="Gatsby 4.17.0"/><style data-href="/blog/styles.a9ca0bb346ac43a02f40.css" data-identity="gatsby-global-css">html{font-size:100}body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizelegibility;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#212121;font-size:16px;line-height:1.625;margin:0 0 0 calc(100vw - 100%)}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:40px;line-height:52px;margin-bottom:26px;margin-top:104px}h2{font-size:27px;line-height:39px}h2,h3{margin-bottom:13px;margin-top:52px}h3{font-size:22px;line-height:26px}h4{font-size:19.2px;margin-top:39px}h4,h5{line-height:26px;margin-bottom:13px}h5,h6{font-size:16px;margin-top:65px}h6{line-height:26px;margin-bottom:13px}img{max-width:100%}hr,img{border:0;display:block}hr{background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#212121 0,#212121 15px,transparent 0,transparent 26px);background-size:100% 26px;color:#212121;height:26px;margin:52px auto;width:100px}a{color:#5c92ff;text-decoration:none}a:active,a:focus,a:hover{color:#f7a145}b,strong{font-weight:600}ul{list-style:square;margin-bottom:26px}ul li{margin-bottom:10px;padding:0 5px}p{line-height:26px;margin-bottom:26px}blockquote{border-left:5px solid #39f;font-style:italic;padding:0}blockquote>p{padding-left:15px}blockquote>p>code[class*=language-]{overflow-wrap:break-word}figure{display:block;height:auto;width:100%}figcaption{color:#212121;font-size:14px;font-style:italic;line-height:19.5px;margin-bottom:0;margin-top:6.5px;text-align:center}.anchor{margin-left:-30px!important;padding-right:14px!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:310px;padding:0 26px}.float-right{float:right}.float-left{float:left}}body :not(pre)>code.language-text{background-color:rgba(27,31,35,.05);color:#000;display:inline-block;max-width:100%;white-space:inherit}body :not(pre)>code.language-text::selection{background-color:#d2d8fb}body code[class*=language-],body pre[class*=language-]{background-color:#000;color:#dcdcdc}body code[class*=language-] ::selection,body pre[class*=language-] ::selection{background-color:#d2d8fb;color:#fff}body .token.atrule,body .token.attr-value,body .token.keyword{color:#39f}body .token.punctuation{color:#dcdcdc}table{border-collapse:collapse;border-top:1px solid #444;width:100%}td,th{border-bottom:1px solid #444;padding:10px;text-align:center}a{overflow-wrap:break-word}code[class*=language-],pre[class*=language-]{word-wrap:normal;color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#073642}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{background:#eee8d5;color:#657b83;cursor:help}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.Content-module--content--uGfLc{margin:0 auto;max-width:1100px;padding:0 15px}.Content-module--content__title--P67He{font-size:32px;font-weight:600;line-height:42.9px;margin:26px auto 0;max-width:950px;text-align:center}.Content-module--content__body--ESt1v figure{margin-bottom:26px}.Content-module--content__body--ESt1v figure blockquote{font-style:italic;margin-top:0;padding:26px 0;text-align:center}.Content-module--content__body--ESt1v figure blockquote p{font-size:26.9072px;line-height:39px;margin-bottom:26px;margin-top:0;max-width:950px}.Content-module--content__body--ESt1v a{text-decoration:underline}.Content-module--content__body--ESt1v *{margin-left:auto;margin-right:auto;max-width:950px}.Content-module--content__body--ESt1v img{max-width:100%}@media screen and (min-width:960px){.Content-module--content--uGfLc{padding:0}.Content-module--content__title--P67He{font-size:48px;line-height:58.5px;margin-bottom:39px;margin-top:58.5px}.Content-module--content__body--ESt1v,.Content-module--content__body--ESt1v p{font-size:18px;line-height:29.25px;margin-bottom:29.25px}}.Skills-module--skills-layout__back-button--WtT2H{border:1px solid #e6e6e6;border-radius:20px;color:#212121;cursor:pointer;display:block;font-size:16px;font-weight:400;height:35px;line-height:35px;margin-left:auto;margin-right:auto;margin-top:26px;max-width:90px;padding:0 24px;text-align:center}.Skills-module--skills-layout__back-button--WtT2H:focus,.Skills-module--skills-layout__back-button--WtT2H:hover{color:#5c92ff}.Skills-module--skills-layout--ni4Gs .Skills-module--skills-wrap--K9NpF{grid-column-gap:3px;grid-row-gap:2px;display:grid;grid-template-columns:none}.Skills-module--skills-layout--ni4Gs .Skills-module--skills-wrap--K9NpF .Skills-module--skills--HhddO{align-items:flex-start;border-left:1px solid #e1e1e1;display:flex;flex-direction:column;flex-wrap:wrap;margin-bottom:15px;padding-left:25px}.Skills-module--skills-layout--ni4Gs .Skills-module--skills-wrap--K9NpF .Skills-module--skills__header--6ce4u{color:#5d686f;display:block;margin-top:5px}.Skills-module--skills-layout--ni4Gs .Skills-module--skills-wrap--K9NpF .Skills-module--skills__container--QeGTT{padding-left:40px;padding-top:8px}.Skills-module--skills-layout--ni4Gs .Skills-module--skills-wrap--K9NpF .Skills-module--skills__container--QeGTT ul{margin-bottom:5px;margin-top:0;padding-left:0}.Skills-module--skills-layout--ni4Gs .Skills-module--skills-wrap--K9NpF .Skills-module--skills__container--QeGTT ul li{list-style-type:disc;margin-bottom:2px;margin-left:30px;margin-top:0}.Skills-module--skills-layout--ni4Gs .Skills-module--skills-wrap--K9NpF .Skills-module--skills__container--QeGTT ul li span{color:#5d686f}.Skills-module--skills-layout--ni4Gs .Skills-module--skills-wrap--K9NpF .Skills-module--skills__subtitle--1BtKD{color:#5d686f;margin:0}.Skills-module--skills-layout--ni4Gs .Skills-module--skills-wrap--K9NpF .Skills-module--skills__subtitle--1BtKD:not(:first-child){margin-top:0}@media screen and (min-width:960px){.Skills-module--skills-layout__back-button--WtT2H{left:30px;margin:0;max-width:auto;position:fixed;top:30px}.Skills-module--skills-layout--ni4Gs .Skills-module--skills-wrap--K9NpF{grid-template-columns:repeat(3,1fr)}}.Feed-module--feed--piBJn .Feed-module--item--x6Y5v{margin-bottom:32.5px}.Feed-module--feed--piBJn .Feed-module--item--x6Y5v:last-child{margin-bottom:13px}.Feed-module--feed--piBJn .Feed-module--item--x6Y5v .Feed-module--title--8lL66{font-size:27px;line-height:39px;margin-bottom:13px;margin-top:0}.Feed-module--feed--piBJn .Feed-module--item--x6Y5v .Feed-module--title--8lL66 .Feed-module--link--YSO-D{color:#212121}.Feed-module--feed--piBJn .Feed-module--item--x6Y5v .Feed-module--title--8lL66 .Feed-module--link--YSO-D:focus,.Feed-module--feed--piBJn .Feed-module--item--x6Y5v .Feed-module--title--8lL66 .Feed-module--link--YSO-D:hover{border-bottom:1px solid #212121;color:#212121}.Feed-module--feed--piBJn .Feed-module--item--x6Y5v .Feed-module--description--VzSOs{font-size:16px;line-height:26px;margin-bottom:19.5px}.Feed-module--feed--piBJn .Feed-module--item--x6Y5v .Feed-module--meta--JQwiD .Feed-module--time--coZK5{color:#212121;font-size:14px;font-weight:600;text-transform:uppercase}.Feed-module--feed--piBJn .Feed-module--item--x6Y5v .Feed-module--meta--JQwiD .Feed-module--divider--gaGDJ{margin:0 13px}.Feed-module--feed--piBJn .Feed-module--item--x6Y5v .Feed-module--meta--JQwiD .Feed-module--category--WfWA4 .Feed-module--link--YSO-D{color:#f7a145;font-size:14px;font-weight:600;text-transform:uppercase}.Feed-module--feed--piBJn .Feed-module--item--x6Y5v .Feed-module--meta--JQwiD .Feed-module--category--WfWA4 .Feed-module--link--YSO-D:focus,.Feed-module--feed--piBJn .Feed-module--item--x6Y5v .Feed-module--meta--JQwiD .Feed-module--category--WfWA4 .Feed-module--link--YSO-D:hover{color:#5c92ff}.Feed-module--feed--piBJn .Feed-module--item--x6Y5v .Feed-module--more--UaTkA{color:#5c92ff;font-size:16px}.Feed-module--feed--piBJn .Feed-module--item--x6Y5v .Feed-module--more--UaTkA:focus,.Feed-module--feed--piBJn .Feed-module--item--x6Y5v .Feed-module--more--UaTkA:hover{border-bottom:1px solid #5c92ff;color:#5c92ff}.Icon-module--icon--HX2j3{fill:currentcolor;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;speak:none;stroke:currentcolor;stroke-width:0;display:inline-block;font-style:normal;font-variant:normal;font-weight:400;height:1em;line-height:1em;text-align:center;text-transform:none;width:1em}.SideButton-module--sides--sxqRm{margin-bottom:26px}.SideButton-module--sides-buttons--CcMjz{bottom:10px;display:flex;flex-direction:column;list-style:none;margin:0;padding:0;position:fixed;right:15px;transition:all .5s ease-in-out}.SideButton-module--sides-buttons-hide--OdyhS{bottom:-180px!important}.SideButton-module--sides-button--pA2tl{align-items:center;background-color:#fff;border:1px solid #ebebeb;border-radius:50%;color:#212121;cursor:pointer;display:flex;height:50px;justify-content:center;line-height:50px;margin:0;padding:0;text-align:center;width:50px}.SideButton-module--sides-button--pA2tl:focus,.SideButton-module--sides-button--pA2tl:hover{color:#5c92ff}@media screen and (min-width:960px){.SideButton-module--sides--sxqRm ul{bottom:100px;right:70px}}.Layout-module--layout--LJM9v{margin-left:auto;margin-right:auto;max-width:1200px;position:relative}.Layout-module--layout--LJM9v:before{content:"";display:table}.Layout-module--layout--LJM9v:after{clear:both;content:"";display:table}.Layout-module--layout-doc-mask--qkYmG{height:30%;position:absolute;top:70%}.Page-module--page--JOA3M{margin-bottom:52px}.Page-module--page--JOA3M .Page-module--inner--SzHbJ{padding:26px 19.5px 0}.Page-module--page--JOA3M .Page-module--title--kDOIG{font-size:40px;font-weight:600;line-height:52px;margin-bottom:37.7px;margin-top:0}.Page-module--page--JOA3M .Page-module--body--VhxOl{font-size:16px;line-height:26px;margin:0 0 26px}@media screen and (min-width:685px){.Page-module--page--JOA3M{width:calc(58.275% - 12.5px)}.Page-module--page--JOA3M:nth-child(1n){clear:none;float:left;margin-right:30px}.Page-module--page--JOA3M:last-child{margin-right:0}.Page-module--page--JOA3M:nth-child(12n){float:right;margin-right:0}.Page-module--page--JOA3M:nth-child(12n+1){clear:both}.Page-module--page--JOA3M .Page-module--inner--SzHbJ{padding:32.5px 19.5px 0}}@media screen and (min-width:960px){.Page-module--page--JOA3M{width:calc(66.6% - 10px)}.Page-module--page--JOA3M:nth-child(1n){clear:none;float:left;margin-right:30px}.Page-module--page--JOA3M:last-child{margin-right:0}.Page-module--page--JOA3M:nth-child(3n){float:right;margin-right:0}.Page-module--page--JOA3M:nth-child(3n+1){clear:both}.Page-module--page--JOA3M .Page-module--inner--SzHbJ{padding:39px 26px 0}}.Pagination-module--pagination--1hy6\+{display:flex;margin-top:52px}.Pagination-module--pagination--1hy6\+ .Pagination-module--previous--Sna5M{text-align:left;width:50%}.Pagination-module--pagination--1hy6\+ .Pagination-module--previous--Sna5M .Pagination-module--previousLink--VZDX6{color:#f7a145;font-size:26px;font-weight:700}.Pagination-module--pagination--1hy6\+ .Pagination-module--previous--Sna5M .Pagination-module--previousLink--VZDX6:focus,.Pagination-module--pagination--1hy6\+ .Pagination-module--previous--Sna5M .Pagination-module--previousLink--VZDX6:hover{color:#5c92ff}.Pagination-module--pagination--1hy6\+ .Pagination-module--previous--Sna5M .Pagination-module--previousLink--VZDX6.Pagination-module--disable--fhBRq{color:#9b9b9b;pointer-events:none}.Pagination-module--pagination--1hy6\+ .Pagination-module--next--HKuPy{text-align:right;width:50%}.Pagination-module--pagination--1hy6\+ .Pagination-module--next--HKuPy .Pagination-module--nextLink--Uy-6W{color:#f7a145;font-size:26px;font-weight:700}.Pagination-module--pagination--1hy6\+ .Pagination-module--next--HKuPy .Pagination-module--nextLink--Uy-6W:focus,.Pagination-module--pagination--1hy6\+ .Pagination-module--next--HKuPy .Pagination-module--nextLink--Uy-6W:hover{color:#5c92ff}.Pagination-module--pagination--1hy6\+ .Pagination-module--next--HKuPy .Pagination-module--nextLink--Uy-6W.Pagination-module--disable--fhBRq{color:#9b9b9b;pointer-events:none}.Author-module--author--y9MUW .Author-module--photo--l4ewo{background-clip:padding-box;border-radius:50%;display:inline-block;height:75px;margin-bottom:0;width:75px}.Author-module--author--y9MUW .Author-module--title--z35RG{font-size:18px;font-weight:600;line-height:29.25px;margin:13px 0}.Author-module--author--y9MUW .Author-module--title--z35RG .Author-module--link--CcF2i,.Author-module--author--y9MUW .Author-module--title--z35RG .Author-module--link--CcF2i:focus,.Author-module--author--y9MUW .Author-module--title--z35RG .Author-module--link--CcF2i:hover{color:#212121}.Author-module--author--y9MUW .Author-module--subtitle--huxcU{color:#878787;line-height:26px;margin-bottom:26px}.Contacts-module--contacts--CReI-{margin-bottom:26px}.Contacts-module--contacts--CReI- .Contacts-module--list--lnC5q{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;margin:13px 0;max-width:150px;padding:0}.Contacts-module--contacts--CReI- .Contacts-module--list--lnC5q .Contacts-module--item--\+csDa{align-content:center;align-items:center;border:1px solid #ebebeb;border-radius:50%;display:flex;height:35px;justify-content:center;line-height:35px;margin:6.5px;padding:0;text-align:center;width:35px}.Contacts-module--contacts--CReI- .Contacts-module--list--lnC5q .Contacts-module--item--\+csDa:nth-child(3n+1){margin-left:0}.Contacts-module--contacts--CReI- .Contacts-module--list--lnC5q .Contacts-module--item--\+csDa .Contacts-module--link--3h4H4{border:0;color:#212121;display:flex}.Contacts-module--contacts--CReI- .Contacts-module--list--lnC5q .Contacts-module--item--\+csDa .Contacts-module--link--3h4H4:focus,.Contacts-module--contacts--CReI- .Contacts-module--list--lnC5q .Contacts-module--item--\+csDa .Contacts-module--link--3h4H4:hover{color:#5c92ff}.Copyright-module--copyright--LGAkk{color:#999;font-size:14px}.Menu-module--menu--ETqdK{margin-bottom:26px}.Menu-module--menu--ETqdK .Menu-module--list--4a49Z{list-style:none;margin:0;padding:0}.Menu-module--menu--ETqdK .Menu-module--list--4a49Z .Menu-module--item--i2edw{margin:13px 0;padding:0}.Menu-module--menu--ETqdK .Menu-module--list--4a49Z .Menu-module--item--i2edw .Menu-module--link--pvAqj{border:0;color:#212121;font-size:16px;font-weight:400}.Menu-module--menu--ETqdK .Menu-module--list--4a49Z .Menu-module--item--i2edw .Menu-module--link--pvAqj:focus,.Menu-module--menu--ETqdK .Menu-module--list--4a49Z .Menu-module--item--i2edw .Menu-module--link--pvAqj:hover{border-bottom:1px solid #5c92ff;color:#5c92ff}.Menu-module--menu--ETqdK .Menu-module--list--4a49Z .Menu-module--item--i2edw .Menu-module--link--pvAqj.Menu-module--active--bLdMz{border-bottom:1px solid #212121;color:#212121}.Sidebar-module--sidebar--G-oUa{width:100%}.Sidebar-module--sidebar--G-oUa .Sidebar-module--inner--NE0Oo{padding:26px 19.5px 0;position:relative}@media screen and (min-width:685px){.Sidebar-module--sidebar--G-oUa{width:calc(41.625% - 17.5px)}.Sidebar-module--sidebar--G-oUa:nth-child(1n){clear:none;float:left;margin-right:30px}.Sidebar-module--sidebar--G-oUa:last-child{margin-right:0}.Sidebar-module--sidebar--G-oUa:nth-child(12n){float:right;margin-right:0}.Sidebar-module--sidebar--G-oUa:nth-child(12n+1){clear:both}.Sidebar-module--sidebar--G-oUa .Sidebar-module--inner--NE0Oo{padding:32.5px 19.5px 0}.Sidebar-module--sidebar--G-oUa .Sidebar-module--inner--NE0Oo:after{background:#e6e6e6;background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);bottom:0;content:"";height:540px;position:absolute;right:-10px;top:30px;width:1px}}@media screen and (min-width:960px){.Sidebar-module--sidebar--G-oUa{width:calc(24.975% - 22.5px)}.Sidebar-module--sidebar--G-oUa:nth-child(1n){clear:none;float:left;margin-right:30px}.Sidebar-module--sidebar--G-oUa:last-child{margin-right:0}.Sidebar-module--sidebar--G-oUa:nth-child(4n){float:right;margin-right:0}.Sidebar-module--sidebar--G-oUa:nth-child(4n+1){clear:both}.Sidebar-module--sidebar--G-oUa .Sidebar-module--inner--NE0Oo{padding:39px}}.TotalSearch-module--search--aZIhb{background-color:#fff;display:flex;padding:16px 0;position:-webkit-sticky;position:sticky;top:0}.TotalSearch-module--search-keyword--iOIAR{border:1px solid gray;border-radius:4px;font-size:16px;font-weight:400;height:48px;padding:0 16px;width:100%}@media screen and (min-width:960px){.TotalSearch-module--skills-layout__back-button--YjdJg{left:30px;margin:0;max-width:auto;position:fixed;top:30px}.TotalSearch-module--skills-layout--9u5bv .TotalSearch-module--skills-wrap--mebnz{grid-template-columns:repeat(3,1fr)}}.Author-module--author--HFjbH{border-top:1px solid #e6e6e6;line-height:26px;margin-bottom:52px;margin-top:26px;max-width:950px;padding-top:26px}.Author-module--author--HFjbH .Author-module--bio--CJUED .Author-module--twitter--kGR0t{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--HFjbH{margin-left:auto;margin-right:auto}}.Content-module--content--gNWBo{margin:0 auto;max-width:1100px;padding:0 13px}.Content-module--content--gNWBo .Content-module--title--CVBL0{font-size:32px;font-weight:600;line-height:42.9px;margin:26px auto 0;max-width:950px;text-align:center}.Content-module--content--gNWBo .Content-module--body--cmwhi figure{margin-bottom:26px}.Content-module--content--gNWBo .Content-module--body--cmwhi figure blockquote{font-style:italic;margin-top:0;padding:26px 0;text-align:center}.Content-module--content--gNWBo .Content-module--body--cmwhi figure blockquote p{font-size:26.9072px;line-height:39px;margin-bottom:26px;margin-top:0;max-width:950px}.Content-module--content--gNWBo .Content-module--body--cmwhi a{text-decoration:underline}.Content-module--content--gNWBo .Content-module--body--cmwhi *{margin-left:auto;margin-right:auto;max-width:950px}.Content-module--content--gNWBo .Content-module--body--cmwhi h2>a{visibility:hidden}.Content-module--content--gNWBo .Content-module--body--cmwhi img{max-width:100%}@media screen and (min-width:960px){.Content-module--content--gNWBo{padding:0}.Content-module--content--gNWBo .Content-module--title--CVBL0{font-size:48px;line-height:58.5px;margin-bottom:39px;margin-top:58.5px}.Content-module--content--gNWBo .Content-module--body--cmwhi,.Content-module--content--gNWBo .Content-module--body--cmwhi p{font-size:18px;line-height:29.25px;margin-bottom:29.25px}.Content-module--content--gNWBo .Content-module--body--cmwhi h2>a{padding-right:26px;visibility:unset}}.Meta-module--meta--2uCvT .Meta-module--date--TTDWL{font-style:italic}.Tags-module--tags--GFiVM{margin-bottom:13px}.Tags-module--tags--GFiVM .Tags-module--list--gq5ra{list-style:none;padding:0}.Tags-module--tags--GFiVM .Tags-module--list--gq5ra .Tags-module--item--UgFWJ{display:inline-block;margin:13px 3.25px}@media screen and (min-width:685px){.Tags-module--tags--GFiVM .Tags-module--list--gq5ra .Tags-module--item--UgFWJ:first-child{margin-left:0;padding-left:0}}.Tags-module--tags--GFiVM .Tags-module--list--gq5ra .Tags-module--item--UgFWJ .Tags-module--link--5O4-1{border:1px solid #e6e6e6;border-radius:20px;color:#212121;display:inline-block;height:35px;line-height:35px;padding:0 19.5px;text-decoration:none}.Tags-module--tags--GFiVM .Tags-module--list--gq5ra .Tags-module--item--UgFWJ .Tags-module--link--5O4-1:focus,.Tags-module--tags--GFiVM .Tags-module--list--gq5ra .Tags-module--item--UgFWJ .Tags-module--link--5O4-1:hover{color:#5c92ff}.Post-module--post--OplAV .Post-module--content--PG5Wp{margin:0 auto}.Post-module--post--OplAV .Post-module--comments--07meJ,.Post-module--post--OplAV .Post-module--footer--\+HBcE{margin:0 auto;max-width:950px;padding:0 13px}.Post-module--post--OplAV .Post-module--button--Ufj7H{border:1px solid #e6e6e6;border-radius:20px;color:#212121;cursor:pointer;display:block;font-size:16px;font-weight:400;height:35px;line-height:35px;margin-left:auto;margin-right:auto;margin-top:26px;max-width:90px;padding:0 26px;text-align:center}.Post-module--post--OplAV .Post-module--button--Ufj7H:focus,.Post-module--post--OplAV .Post-module--button--Ufj7H:hover{color:#5c92ff}@media screen and (min-width:960px){.Post-module--post--OplAV .Post-module--comments--07meJ,.Post-module--post--OplAV .Post-module--footer--\+HBcE{padding:0}.Post-module--post--OplAV .Post-module--button--Ufj7H{left:30px;margin:0;max-width:none;position:fixed;top:30px}}.Tags-module--tags--KfLu\+{grid-gap:11px 20px;display:flex;flex-wrap:wrap}.Tags-module--tags__tag--nij2v{align-items:center;background:#f1f3f5;border-radius:20px;color:#0ca678;cursor:pointer;display:inline-flex;height:35px;padding:0 10px}</style><link rel="alternate" type="application/rss+xml" title="Blog by joohyung" href="/blog/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id="></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', '', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/blog/sitemap/sitemap-index.xml"/><link rel="icon" href="/blog/favicon-32x32.png?v=a0e002f394141892bab003cbb7dcfd9b" type="image/png"/><link rel="manifest" href="/blog/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/blog/icons/icon-48x48.png?v=a0e002f394141892bab003cbb7dcfd9b"/><link rel="apple-touch-icon" sizes="72x72" href="/blog/icons/icon-72x72.png?v=a0e002f394141892bab003cbb7dcfd9b"/><link rel="apple-touch-icon" sizes="96x96" href="/blog/icons/icon-96x96.png?v=a0e002f394141892bab003cbb7dcfd9b"/><link rel="apple-touch-icon" sizes="144x144" href="/blog/icons/icon-144x144.png?v=a0e002f394141892bab003cbb7dcfd9b"/><link rel="apple-touch-icon" sizes="192x192" href="/blog/icons/icon-192x192.png?v=a0e002f394141892bab003cbb7dcfd9b"/><link rel="apple-touch-icon" sizes="256x256" href="/blog/icons/icon-256x256.png?v=a0e002f394141892bab003cbb7dcfd9b"/><link rel="apple-touch-icon" sizes="384x384" href="/blog/icons/icon-384x384.png?v=a0e002f394141892bab003cbb7dcfd9b"/><link rel="apple-touch-icon" sizes="512x512" href="/blog/icons/icon-512x512.png?v=a0e002f394141892bab003cbb7dcfd9b"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true">IntelliJ Async Profiler - Blog by joohyung</title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--LJM9v"><div class="Post-module--post--OplAV"><a class="Post-module--button--Ufj7H">뒤로가기</a><div class="Post-module--content--PG5Wp"><div class="Content-module--content--gNWBo"><h1 class="Content-module--title--CVBL0">IntelliJ Async Profiler</h1><div class="Content-module--body--cmwhi"><h1 id="async-profiler" style="position:relative;"><a href="#async-profiler" aria-label="async profiler permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Async Profiler</h1>
<p>서비스를 운영하다 보면 병목이나 특정 메소드에서 서버 리소스를 많이 사용하는 부분이 생길 수도 있다. 이러한 지점을 찾기 위한 도구로, 어느 구간에서 cpu를 많이 사용하는지, 어느 구간에서 메모리(<code class="language-text">heap</code>, <code class="language-text">native memory</code>)를 많이 쓰는지를 시각화 하여 보여준다.
<a href="https://github.com/async-profiler/async-profiler" target="_blank" rel="nofollow noopener noreferrer">해당 서비스</a>에선 아래와 같은 항목들 추적이 가능하다.</p>
<blockquote>
<p>What can be profiled:</p>
<ul>
<li>CPU time</li>
<li>Allocations in Java Heap</li>
<li>Native memory allocations and leaks</li>
<li>Contended locks</li>
<li>Hardware and software performance counters like cache misses, page faults, context switches</li>
</ul>
</blockquote>
<p>이러한 항목들을 샘플링 방식으로 스레드 단위로 수집하여 어떠한 스레드가 리소스를 많이 사용한건지 확인 가능하며, 오버헤드도 상당히 낮은 수준으로 수집하여 필요하면 운영환경에서도 사용하도록 제공해주고 있다.</p>
<h1 id="intellij-profiler" style="position:relative;"><a href="#intellij-profiler" aria-label="intellij profiler permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IntelliJ Profiler</h1>
<p><code class="language-text">IntelliJ</code>에서 <code class="language-text">Async Profiler</code> 비스무리하게 만들어 제공해주는 기능으로 앞서 소개한 항목에 추가로 <code class="language-text">total time</code>도 함께 제공해주고 있어, 병목지점까지 한눈에 볼 수 있게 제공해주고 있다.</p>
<h2 id="1-cpu-사용량을-통한-병목지점-확인" style="position:relative;"><a href="#1-cpu-%EC%82%AC%EC%9A%A9%EB%9F%89%EC%9D%84-%ED%86%B5%ED%95%9C-%EB%B3%91%EB%AA%A9%EC%A7%80%EC%A0%90-%ED%99%95%EC%9D%B8" aria-label="1 cpu 사용량을 통한 병목지점 확인 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. CPU 사용량을 통한 병목지점 확인</h2>
<p>예를들어 아래와 같은 예시가 있다.</p>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token comment">// CpuTest.kt</span>
<span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> first <span class="token operator">=</span> <span class="token function">IntArray</span><span class="token punctuation">(</span><span class="token number">100_000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> Random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> seconds <span class="token operator">=</span> <span class="token function">IntArray</span><span class="token punctuation">(</span><span class="token number">50_000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> Random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token function">countSameNumberUsingList</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> seconds<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fun</span> <span class="token function">countSameNumberUsingList</span><span class="token punctuation">(</span>first<span class="token operator">:</span> List<span class="token operator">&lt;</span>Int<span class="token operator">></span><span class="token punctuation">,</span> seconds<span class="token operator">:</span> List<span class="token operator">&lt;</span>Int<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> elapsed <span class="token operator">=</span> measureTimeMillis <span class="token punctuation">{</span>
        <span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>x <span class="token keyword">in</span> first<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token keyword">in</span> seconds<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                count<span class="token operator">++</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"공통 숫자 개수=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">count</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"List 걸린시간(ms)=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">elapsed</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>두 리스트 <code class="language-text">first</code>, <code class="language-text">seconds</code>에서 랜덤하게 숫자를 채우고, 같은 숫자 개수를 구하는 내용이다.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 580px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/11695b6f576ab65dca53b1f5cd9619b9/12f38/intellij-profiler1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 45.378151260504204%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB1ElEQVQoz3XSbWvTYBTG8XyPDVybdm1W2Jxbnu/cSbosbdNmyfpgW8HpWrs3gg6ZykSF+oTg0I/8l8ayN9IXPzic69XhOoorA1wZbuavNPHCE3pJwnCYMRrlTCZ9sqyNDC1k5CB9G+lZKMIPkdJFSgfpOfj+el4TwsK2dYTnIPO3xE9/0Ln4hj/5ijv8gpl/wMzfYJ2/x8o/oxiWi//4lmR+R3d2x9niN735HcnlL7LFHzrPfhJOv+MmM+x4TvZ8yWixJLlYIvq3mN1XWN0rrPQlVnqDUlardAcvGMw+kl9+Yny1JHnyjrD/mmh0TTS8Jh7fIFpTXEcnjpu02xHxqY/nGnjCxBM2nrDwhIFSqVTpndq02006nZg07RAEAscxcBxzzcAVDiI4oZf16eUrA5I0J4haeGGEDKMiV1S1Qhi16GXnRK2kKMDxgiIsFIVEmLagUq1Sq9Wp1etoe3vUNY3d3VqxV6s1jnUdZRUIGXCW92kl3ULcTliV9e8DgmI2bAdVLVMu/09VVUqlEo90E2X/4AAZnjAaT0nSjKjVKax2XtAsrM6xhaTRaGykaRq1uoayUypxpJuYtsvhkX7vSDfuHRsW+w8P2d7e3mhra4vSzgP+Ai3iOdBz/8jdAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/blog/static/11695b6f576ab65dca53b1f5cd9619b9/24599/intellij-profiler1.webp 238w,
/blog/static/11695b6f576ab65dca53b1f5cd9619b9/69f92/intellij-profiler1.webp 475w,
/blog/static/11695b6f576ab65dca53b1f5cd9619b9/2af67/intellij-profiler1.webp 580w"
              sizes="(max-width: 580px) 100vw, 580px"
              type="image/webp"
            />
          <source
            srcset="/blog/static/11695b6f576ab65dca53b1f5cd9619b9/da2e6/intellij-profiler1.png 238w,
/blog/static/11695b6f576ab65dca53b1f5cd9619b9/abae4/intellij-profiler1.png 475w,
/blog/static/11695b6f576ab65dca53b1f5cd9619b9/12f38/intellij-profiler1.png 580w"
            sizes="(max-width: 580px) 100vw, 580px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/blog/static/11695b6f576ab65dca53b1f5cd9619b9/12f38/intellij-profiler1.png"
            alt="intellij-profile1"
            title="intellij-profile1"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span> 버튼을 누르면 해당 프로그램을 <code class="language-text">IntelliJ Profiler</code>로 실행 된다.</p>
<blockquote>
<p>주황색 아이콘은 VisualVM 버튼으로 IntelliJ와 연동해서 사용하고 있는데, AsyncProfiler와 무관하니 무시</p>
</blockquote>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Profiling started
공통 숫자 개수=2
List 걸린시간(ms)=2443</code></pre></div>
<p>프로그램이 종료 되고, <code class="language-text">Show Results</code> 버튼을 누르면 아래와 같은 화면이 출력된다.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 950px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/de41b4d6f1e8531150cb67e7143f7ba0/b4ad3/intellij-profiler2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 41.1764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABSklEQVQoz5WQXU/CMBRA+VcqbG3XbWygYxsIDlQIigsa5EMQHjQ++MeP6RwGiS8+nNy2tzn3o3I+eCG6XqHbc6zoCe2HKNfD8epI7VKzJTWhfrCkg3BcbKVRro8fNvGCRnE3VNJ+TpJNUI0MEXSxlUv1QGIEf533mL8Gk7OEQ6UeBgSNEO25SKWQ2iuSplrx6Z9U9hWqtiokRnhStTit2VRtcdDdEaLk560UHtrNvhwvIOlcEbd7+OEFUvtYUh+N6vxJMfJ+LyaeWYJmFDNfblisNuTTGZe9AVFyScuQdonTLq2kQxS3uWilKK2xpUSUXf4SnlqCJD7nYzvlfZPztn5gtxizm49YTgc8T3os8ozZXYfpMOJx2GIyCLnvB4yzEOnoY6EkjXw+133eZ21eJ3W2DwHrsWZxa39z8x2XQ1EiWY0ky6HC912+AAj8JwZDYmILAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/blog/static/de41b4d6f1e8531150cb67e7143f7ba0/24599/intellij-profiler2.webp 238w,
/blog/static/de41b4d6f1e8531150cb67e7143f7ba0/69f92/intellij-profiler2.webp 475w,
/blog/static/de41b4d6f1e8531150cb67e7143f7ba0/cebde/intellij-profiler2.webp 950w,
/blog/static/de41b4d6f1e8531150cb67e7143f7ba0/5c666/intellij-profiler2.webp 1080w"
              sizes="(max-width: 950px) 100vw, 950px"
              type="image/webp"
            />
          <source
            srcset="/blog/static/de41b4d6f1e8531150cb67e7143f7ba0/da2e6/intellij-profiler2.png 238w,
/blog/static/de41b4d6f1e8531150cb67e7143f7ba0/abae4/intellij-profiler2.png 475w,
/blog/static/de41b4d6f1e8531150cb67e7143f7ba0/68327/intellij-profiler2.png 950w,
/blog/static/de41b4d6f1e8531150cb67e7143f7ba0/b4ad3/intellij-profiler2.png 1080w"
            sizes="(max-width: 950px) 100vw, 950px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/blog/static/de41b4d6f1e8531150cb67e7143f7ba0/68327/intellij-profiler2.png"
            alt="intellij-profile2"
            title="intellij-profile2"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h3 id="왼쪽-상단-메뉴" style="position:relative;"><a href="#%EC%99%BC%EC%AA%BD-%EC%83%81%EB%8B%A8-%EB%A9%94%EB%89%B4" aria-label="왼쪽 상단 메뉴 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>왼쪽 상단 메뉴</h3>
<ol>
<li>Flame Graph</li>
</ol>
<p>왼쪽엔 실행 된 스레드명을 나열하고 오른쪽엔 호출된 call stack별로 메소드들을 확인 할 수 있다. x축이 넓을수록 리소스를 많이 사용한 부분이고, y축은 call stack기준으로 메소드들을 보여준다. 갈색은 java 코딩한 메소드, 회색은 라이브러리를 보여준다.</p>
<p>이미지를 기준으로 보자면 <code class="language-text">DestroyJavaVM</code>이란 스레드가 대부분의 cpu를 사용했고, <code class="language-text">countSameNumberUsingList</code> -> <code class="language-text">measureTimeMillis</code> -> <code class="language-text">ArrayList.contains</code> 메소드가 대부분의 cpu를 사용했다는 점을 확인 할 수 있다.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 899px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/6320c3cbcd3799b6346197a14eaf5835/f7121/intellij-profiler3.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 26.89075630252101%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGElEQVQY013PbU+CYBTGcT6UFhTiE4jADTeiZs75UIYaolm5pDU326qtT/1v2rLVi9+u8+LsXDtKu9MjnqWMJwnD6wlhs4uQrX/a1L0Qqy6oOf4hixULo2xSrJjHeU/p9gbM0xWzZMH0NmVfIBsXyKhD+KN5+S3q4AiJkBFCNrDqHqbtYrs+vmwSNNoo6bTP527F28uC9+2SXZbwmiXsnmKy5ZDNon90fxPiOLXD0aARHdS9ANMySa8kD5MIJRl4fKzbbOcBWVzjeWKTxRabcYn1yOBxWDhaD3WEa+KHLcKohSP8w5umVeWuX2A9KqAYxQK6rnF+pqKe5n6peTTt5A9VzaEbRRwRYLseFcvGKFcxSmU0db+T5wvXp8PZflUoOAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/blog/static/6320c3cbcd3799b6346197a14eaf5835/24599/intellij-profiler3.webp 238w,
/blog/static/6320c3cbcd3799b6346197a14eaf5835/69f92/intellij-profiler3.webp 475w,
/blog/static/6320c3cbcd3799b6346197a14eaf5835/fc12c/intellij-profiler3.webp 899w"
              sizes="(max-width: 899px) 100vw, 899px"
              type="image/webp"
            />
          <source
            srcset="/blog/static/6320c3cbcd3799b6346197a14eaf5835/da2e6/intellij-profiler3.png 238w,
/blog/static/6320c3cbcd3799b6346197a14eaf5835/abae4/intellij-profiler3.png 475w,
/blog/static/6320c3cbcd3799b6346197a14eaf5835/f7121/intellij-profiler3.png 899w"
            sizes="(max-width: 899px) 100vw, 899px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/blog/static/6320c3cbcd3799b6346197a14eaf5835/f7121/intellij-profiler3.png"
            alt="intellij-profile3"
            title="intellij-profile3"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span> 그래프 우클릭을 통해 해당 코드로 이동하거나 선택한 메소드를 기준으로 하위 메소드들만 <code class="language-text">Call tree</code>, <code class="language-text">Method List</code>을 볼 수가 있다.</p>
<ol start="2">
<li>Call Tree</li>
</ol>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 856px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/527bd6c0ca047bab552b80d193bd25c4/1712d/intellij-profiler4.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 38.23529411764706%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlklEQVQoz3XRyXITMRDG8XkpDPEskjVaRrNIs3hsYyCESlEUJx4AJyFw46X/VBRy4MDhd2p166vuzDjPTttEGZdI/aRB1ub/lEa7ljYuie1i6stmbZj2B07n98zrkabrkbZHuki1qymlIq/kPwqxI68EwgXMeouarunOX+iXt2Sr0vTdkIbFec8474nTzDgvTMtKOwRq21DtNEI9S5+UgsoF6v0tcryme/eVYX8mG2vNoA1+iAwh0odIGKfEdwPaNSl1077okLWmqCqEG6iXT6j5Bn+4oQ0jmVaG/d+dGd9j2wHbBlwb2GlHKWsKobgqJdtyl+TieQ2iGdHrZ+T4ARtPKUB2tTzSnn8iDw+I9YI+XaiP31HHC9vlkTfzD15P92zGOzbxwibesRnveRUuVIdHzMffbMYH8vUXdv1G5voF5QaMjxgfUjrTzZh+Qbcz2o8I3ZKbidKtFDqyFZpcOgrlKaRlKyyl8uhmIHPeUxuDtg7nW0zjqX3A9DPavdQstbGI2lI9Xd8GCqkoKpGunVcVpZTpzR/cDCoPIw4e1AAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/blog/static/527bd6c0ca047bab552b80d193bd25c4/24599/intellij-profiler4.webp 238w,
/blog/static/527bd6c0ca047bab552b80d193bd25c4/69f92/intellij-profiler4.webp 475w,
/blog/static/527bd6c0ca047bab552b80d193bd25c4/8d208/intellij-profiler4.webp 856w"
              sizes="(max-width: 856px) 100vw, 856px"
              type="image/webp"
            />
          <source
            srcset="/blog/static/527bd6c0ca047bab552b80d193bd25c4/da2e6/intellij-profiler4.png 238w,
/blog/static/527bd6c0ca047bab552b80d193bd25c4/abae4/intellij-profiler4.png 475w,
/blog/static/527bd6c0ca047bab552b80d193bd25c4/1712d/intellij-profiler4.png 856w"
            sizes="(max-width: 856px) 100vw, 856px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/blog/static/527bd6c0ca047bab552b80d193bd25c4/1712d/intellij-profiler4.png"
            alt="intellij-profile4"
            title="intellij-profile4"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span>
말 그대로 메소드에서 호출한 구조를 계층형으로 보여준다. 퍼센트 단위로 어느 구간에서 cpu를 많이 썻는지 직관적으로 확인이 가능하며 <code class="language-text">Flame Graph</code>에서 원하는 메소드를 우클릭 -> <code class="language-text">Focus on method in Call Tree</code>를 개인적으로 가장 많이 사용하고 있다.</p>
<blockquote>
<p>선택한 메소드를 기준으로 Call Tree를 보여준다</p>
</blockquote>
<p>그 외 항목들은 다 직관적이고 위 두 기능만 알면 얼추 감이 잡혀 써보면 바로 이해할 것이다.</p>
<p>결과적으로 위 코드에선 List를 이중으로 순회하면서 값을 찾는 부분(<code class="language-text">ArrayList.contains</code>)에서 가장 많은 리소스를 사용하고 있다. 이를 아래와 같이 <code class="language-text">HashSet</code>을 사용하여 해시키 기반으로 찾도록 개선이 가능하다.</p>
<blockquote>
<p>해시키 기반으로 찾으므로 훨씬 더 효율적으로 검색이 가능하다.</p>
</blockquote>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">fun</span> <span class="token function">countSameNumberUsingSet</span><span class="token punctuation">(</span>first<span class="token operator">:</span> List<span class="token operator">&lt;</span>Int<span class="token operator">></span><span class="token punctuation">,</span> seconds<span class="token operator">:</span> List<span class="token operator">&lt;</span>Int<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> secondsSet <span class="token operator">=</span> seconds<span class="token punctuation">.</span><span class="token function">toHashSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">val</span> elapsed <span class="token operator">=</span> measureTimeMillis <span class="token punctuation">{</span>
        <span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>x <span class="token keyword">in</span> first<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token keyword">in</span> secondsSet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                count<span class="token operator">++</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"공통 숫자 개수=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">count</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Set 걸린시간(ms)=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">elapsed</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>두 메소드들을 아래와 같이 병렬로 실행하고 결과를 보면</p>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> threadPool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

    <span class="token keyword">val</span> first <span class="token operator">=</span> <span class="token function">IntArray</span><span class="token punctuation">(</span><span class="token number">100_000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> Random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> seconds <span class="token operator">=</span> <span class="token function">IntArray</span><span class="token punctuation">(</span><span class="token number">50_000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> Random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    threadPool<span class="token punctuation">.</span><span class="token function">submit</span> <span class="token punctuation">{</span>
        <span class="token function">countSameNumberUsingList</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> seconds<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    threadPool<span class="token punctuation">.</span><span class="token function">submit</span> <span class="token punctuation">{</span>
        <span class="token function">countSameNumberUsingSet</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> seconds<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    threadPool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    threadPool<span class="token punctuation">.</span><span class="token function">awaitTermination</span><span class="token punctuation">(</span><span class="token number">30L</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// Profiling started</span>
<span class="token comment">// 공통 숫자 개수=2</span>
<span class="token comment">// Set 걸린시간(ms)=7</span>
<span class="token comment">// 공통 숫자 개수=2</span>
<span class="token comment">// List 걸린시간(ms)=2458</span></code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 950px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/38cdf4ef0018e9649dabec066e9a1ced/09504/intellij-profiler5.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 35.29411764705882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/ElEQVQoz23Py27CMBCF4TwWNBfP2LETSEggIApVkUBVJVTx/tu/Im0hgS6+heWZ4+MorT6wqy9MeyFtLoifI9ZhXCCxxUAgzpQ4kxFxOdYXZOpIjBItNu90uxNadqR5SyqOODODJTMg/dLfXfIQfhXNqppF05B7j3UOYx0v6TjgTgb0SR/48w29LYvzWF/iQomx/nfwP4/tboH3167N1AW69ZZu/cps3iAaUFfc2YCox2j+5Bo6CpymQlnknI8d5+Oaz8OS077isAnsV5a3zrFrhW2dsl1kT1SFKBk2zATnLMs6Z1l72iqnChlBp3iZ9IJO+vPYBK9TkiTmG+Fb+XV1HMEcAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/blog/static/38cdf4ef0018e9649dabec066e9a1ced/24599/intellij-profiler5.webp 238w,
/blog/static/38cdf4ef0018e9649dabec066e9a1ced/69f92/intellij-profiler5.webp 475w,
/blog/static/38cdf4ef0018e9649dabec066e9a1ced/cebde/intellij-profiler5.webp 950w,
/blog/static/38cdf4ef0018e9649dabec066e9a1ced/53f84/intellij-profiler5.webp 1240w"
              sizes="(max-width: 950px) 100vw, 950px"
              type="image/webp"
            />
          <source
            srcset="/blog/static/38cdf4ef0018e9649dabec066e9a1ced/da2e6/intellij-profiler5.png 238w,
/blog/static/38cdf4ef0018e9649dabec066e9a1ced/abae4/intellij-profiler5.png 475w,
/blog/static/38cdf4ef0018e9649dabec066e9a1ced/68327/intellij-profiler5.png 950w,
/blog/static/38cdf4ef0018e9649dabec066e9a1ced/09504/intellij-profiler5.png 1240w"
            sizes="(max-width: 950px) 100vw, 950px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/blog/static/38cdf4ef0018e9649dabec066e9a1ced/68327/intellij-profiler5.png"
            alt="intellij-profile5"
            title="intellij-profile5"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>오른쪽에 <code class="language-text">pool-1-thread-1</code>, <code class="language-text">pool-1-thread-2</code> 두 스레드 단위로 얼마나 리소스를 사용했는지 or 원하는 스레드만 선택하여 확인도 가능하다.</p>
<blockquote>
<p>단순 두 방법이 얼마나 큰차이가 생기는지만 보여주고 각 방법 별로 왜 개선 된 건지는 그냥 자료구조이므로 자세한 설명은 생략한다.</p>
</blockquote>
<h2 id="2-total-time-통한-병목지점-확인" style="position:relative;"><a href="#2-total-time-%ED%86%B5%ED%95%9C-%EB%B3%91%EB%AA%A9%EC%A7%80%EC%A0%90-%ED%99%95%EC%9D%B8" aria-label="2 total time 통한 병목지점 확인 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Total time 통한 병목지점 확인</h2>
<p>또 다른 예시로 아래와 같은 전체코드가 있다.</p>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> increaseBySynchronized <span class="token operator">=</span> <span class="token function">IncreaseBySynchronized</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> increaseByLongAdder <span class="token operator">=</span> <span class="token function">IncreaseByLongAdder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token function">incrementCheck</span><span class="token punctuation">(</span>increaseBySynchronized<span class="token punctuation">)</span>
    <span class="token function">incrementCheck</span><span class="token punctuation">(</span>increaseByLongAdder<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fun</span> <span class="token function">incrementCheck</span><span class="token punctuation">(</span>increaseTest<span class="token operator">:</span> IncreaseTest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> threads <span class="token operator">=</span> <span class="token number">10</span>
    <span class="token keyword">val</span> pool <span class="token operator">=</span> Executors<span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span>threads<span class="token punctuation">)</span>
    <span class="token keyword">val</span> latch <span class="token operator">=</span> <span class="token function">CountDownLatch</span><span class="token punctuation">(</span>threads<span class="token punctuation">)</span>
    <span class="token keyword">val</span> elapsed <span class="token operator">=</span> measureTimeMillis <span class="token punctuation">{</span>
        <span class="token function">repeat</span><span class="token punctuation">(</span>threads<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            pool<span class="token punctuation">.</span><span class="token function">submit</span> <span class="token punctuation">{</span>
                <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">2_000_000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    increaseTest<span class="token punctuation">.</span><span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
                latch<span class="token punctuation">.</span><span class="token function">countDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        latch<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"counter=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">increaseTest<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, elapsed(ms)=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">elapsed</span></span><span class="token string">, className=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">increaseTest<span class="token punctuation">.</span>javaClass<span class="token punctuation">.</span>simpleName</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> IncreaseTest <span class="token punctuation">{</span>
    <span class="token keyword">fun</span> <span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">fun</span> <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Long
<span class="token punctuation">}</span>

<span class="token keyword">class</span> IncreaseBySynchronized <span class="token operator">:</span> IncreaseTest <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token number">0L</span>
    <span class="token keyword">private</span> <span class="token keyword">var</span> lock<span class="token operator">:</span> Any <span class="token operator">=</span> <span class="token function">Any</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">synchronized</span><span class="token punctuation">(</span>lock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            counter<span class="token operator">++</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Long <span class="token operator">=</span> counter
<span class="token punctuation">}</span>

<span class="token keyword">class</span> IncreaseByLongAdder <span class="token operator">:</span> IncreaseTest <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> counter <span class="token operator">=</span> <span class="token function">LongAdder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">increase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        counter<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Long <span class="token operator">=</span> counter<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// counter=20000000, elapsed(ms)=819, className=IncreaseBySynchronized</span>
<span class="token comment">// counter=20000000, elapsed(ms)=54, className=IncreaseByLongAdder</span></code></pre></div>
<p>10개의 스레드가 동시에 공통변수의 숫자를 하나씩 2,000,000번 증가시키는 코드인데 thread safe를 보장하기 위해 첫번째 방법은 <code class="language-text">synchronized</code>을 사용하고 두번째 방법은 <code class="language-text">LongAdder</code>를 사용해서 thread safe를 보장하였다. 앞서 사용한 방식과 동일하게 <code class="language-text">IntelliJ Profiler</code>를 돌리면 <code class="language-text">Intellij</code> 코드에 아래와 같이 메소드별 걸린 시간도 표기해준다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 838px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/838d30ac3f8c1a714a4e4c907de1b73c/0591a/intellij-profiler9.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 66.38655462184873%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACNUlEQVQ4y22S246jOBBA8w3zsOoE21xsjG0wEEg6aUgy0/Ow0kgrzcvs/3/KWUGzrentfSgjFXDquKp21lr+us58P1/QpqRtG+b5zO32zHy7cHq58Xx/5XJ/5TTdOU936hgpy5Ll3//GLkkSjm1HF1uUUhiTE6MnRrc+XdMS+hN1f6IdrzhXoxJJkgiklAghPsRugSRCsIBzbdFlhXMGHyp8tVg4TBUojGVfCJ6sRPiMosgRiVglfo/dUiWRAiEFKs3Q/sg4f2X6+o3zt5k4Xan7nn7oCUdPcw74oabuB4ytkPIjdJcqxbGsqHWJlAlKB9xxJnQjRVtjrwPtNHJ9XJgeD8ZxpCwKjPVrzxehD8C9SGiNpTElKlWozNB0Pffvr4zXifkx0zSOymq01gipOBwOyK1nC+R36G4KDT+PJy4uoNJ0TWaZwoWa8/XMnz9e+fnrF8PLM+PlyHDqMca8Qz4Z3urI36crc2gQSpKu0HStbkqDiYH+MRFfznTHhmFoqSqLEPLTQN6v/GX/xB/J4Q22WRZZRuYdOjhqp4m1Wwvt94cPV/1kuByDdcSlwUqxDMkGj609duvb+nGq/tfok+FyPDtPX9oVaBaA0eTO4r19G8SyxEJuiyzfzcQWy4D+za17+JQkHLZkWTnarmXoPF2sKYqCVG9R5GhdkGUZeZZR5Nn6Pi/0lkvfDNNNN89zKmdpu5rYeLqlf7VHdw1FHyljIMaALQ3RWZqqpA6e0I/YyhFKzT+lsHW0vxeUUAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/blog/static/838d30ac3f8c1a714a4e4c907de1b73c/24599/intellij-profiler9.webp 238w,
/blog/static/838d30ac3f8c1a714a4e4c907de1b73c/69f92/intellij-profiler9.webp 475w,
/blog/static/838d30ac3f8c1a714a4e4c907de1b73c/25dae/intellij-profiler9.webp 838w"
              sizes="(max-width: 838px) 100vw, 838px"
              type="image/webp"
            />
          <source
            srcset="/blog/static/838d30ac3f8c1a714a4e4c907de1b73c/da2e6/intellij-profiler9.png 238w,
/blog/static/838d30ac3f8c1a714a4e4c907de1b73c/abae4/intellij-profiler9.png 475w,
/blog/static/838d30ac3f8c1a714a4e4c907de1b73c/0591a/intellij-profiler9.png 838w"
            sizes="(max-width: 838px) 100vw, 838px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/blog/static/838d30ac3f8c1a714a4e4c907de1b73c/0591a/intellij-profiler9.png"
            alt="intellij-profile9"
            title="intellij-profile9"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>이 상태에서 화면 아래 우측에 <code class="language-text">Show</code>를 Total Time으로 바꾸면 아래와 같이 출력 된다.</p>
<h3 id="21-total-time---flame-graph" style="position:relative;"><a href="#21-total-time---flame-graph" aria-label="21 total time   flame graph permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.1 total time - Flame Graph</h3>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 950px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/64b545508b4399a0afe5173d1e4b04af/312cc/intellij-profiler6.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 23.10924369747899%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwElEQVQY053P2w7BQBAG4H0tPexRt9SZUqUHKcENesONePZf2rCIxIWLL7P5Z7KZIcwLYFP+N5dLKM+H0j4cJkBsl5lmFTzZFfriMP4gPufePh+FMYhFBSzKaw2HGpbLTW64v7ctNluQW7nA9RjVLvsBzrs+ztsuTrnCMRM4pAJlLrCOJFRT1idSob5U+bVMQIoswiqdocjmWKURlvMxkniCOOwhHGhMh36tencCH0xqSK8NpdumKh1Aei2sFx3cASuCtmbxta2eAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/blog/static/64b545508b4399a0afe5173d1e4b04af/24599/intellij-profiler6.webp 238w,
/blog/static/64b545508b4399a0afe5173d1e4b04af/69f92/intellij-profiler6.webp 475w,
/blog/static/64b545508b4399a0afe5173d1e4b04af/cebde/intellij-profiler6.webp 950w,
/blog/static/64b545508b4399a0afe5173d1e4b04af/e457a/intellij-profiler6.webp 1182w"
              sizes="(max-width: 950px) 100vw, 950px"
              type="image/webp"
            />
          <source
            srcset="/blog/static/64b545508b4399a0afe5173d1e4b04af/da2e6/intellij-profiler6.png 238w,
/blog/static/64b545508b4399a0afe5173d1e4b04af/abae4/intellij-profiler6.png 475w,
/blog/static/64b545508b4399a0afe5173d1e4b04af/68327/intellij-profiler6.png 950w,
/blog/static/64b545508b4399a0afe5173d1e4b04af/312cc/intellij-profiler6.png 1182w"
            sizes="(max-width: 950px) 100vw, 950px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/blog/static/64b545508b4399a0afe5173d1e4b04af/68327/intellij-profiler6.png"
            alt="intellij-profile6"
            title="intellij-profile6"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span>
메소드별 걸린 시간을 그래프로 표현</p>
<h3 id="22-total-time---call-tree" style="position:relative;"><a href="#22-total-time---call-tree" aria-label="22 total time   call tree permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.2 total time - Call Tree</h3>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 950px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/f5766647e2eb95e5d571598428dabe29/cc5fa/intellij-profiler7.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 37.39495798319328%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABLElEQVQoz22O607bQBgF/UhQ1JLE9t6v9jp2HJvSqu//GlNlAQFSfoy+PUfa0Wl0KpxM5FkYnoXlKF3lZ2/4VbHv92v+5Kg8nU3YPKHCQCOEJfiBsv9lXF+Ztj8M629cWdHpTGsTBxU5qMBBR55azeNR8Xh64+Eg+dFZ+vM/zLDQOOMY88CyXrluO+u2M5aC8QkdCtJGhDIIpe8jFdI4ehvxKdM4F4h5JOSROBRiLthYkPGMiCudzbRS0wp1h7e+045TrzA+0hjrmaaZ7eWVdX9hmGZ8ntAu0ClDVz9KOqnru3uX1Sw/ha00uJBobnNTHpmWC8u6MV+uzOvOdNnqaj8uCBu+Sb5Se2XrWntbeBPakGrwMWNDxKQZE0tdKVymd4VO+7vSj+52lXH8B6Af+Zi9weB9AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/blog/static/f5766647e2eb95e5d571598428dabe29/24599/intellij-profiler7.webp 238w,
/blog/static/f5766647e2eb95e5d571598428dabe29/69f92/intellij-profiler7.webp 475w,
/blog/static/f5766647e2eb95e5d571598428dabe29/cebde/intellij-profiler7.webp 950w,
/blog/static/f5766647e2eb95e5d571598428dabe29/145c7/intellij-profiler7.webp 1188w"
              sizes="(max-width: 950px) 100vw, 950px"
              type="image/webp"
            />
          <source
            srcset="/blog/static/f5766647e2eb95e5d571598428dabe29/da2e6/intellij-profiler7.png 238w,
/blog/static/f5766647e2eb95e5d571598428dabe29/abae4/intellij-profiler7.png 475w,
/blog/static/f5766647e2eb95e5d571598428dabe29/68327/intellij-profiler7.png 950w,
/blog/static/f5766647e2eb95e5d571598428dabe29/cc5fa/intellij-profiler7.png 1188w"
            sizes="(max-width: 950px) 100vw, 950px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/blog/static/f5766647e2eb95e5d571598428dabe29/68327/intellij-profiler7.png"
            alt="intellij-profile7"
            title="intellij-profile7"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span>
메소드별 걸린 시간을 계층 구조로 표현</p>
<h3 id="23-total-time---method-list" style="position:relative;"><a href="#23-total-time---method-list" aria-label="23 total time   method list permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.3 total time - Method List</h3>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 950px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/e0ecf7c36a611d1092fe22a117356899/08158/intellij-profiler8.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 18.907563025210084%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAvUlEQVQY02XP7W6CQBCFYa6rwjK7y36BqBUiIIT0/m/ibVy1adofT85kkjPJFDb2VGKystZUD/Irf2bzT60tMbWkrqfxEbENxXRfGaeF8bYQ2h7jY2Z9yt6zbgJiPdK8WI/2LaYbSKcBk86E4yfFtn8xLSvzurFsO8Nt5nwd6U4X7OO4CzmVtvmDsjZPSqhsRNKVcLxQikW7SHHfdsZpJnZ9LruQEOty+aBqPqqng5I/akrjUa7FxTbvlBi+Aa20kUO8f/kQAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/blog/static/e0ecf7c36a611d1092fe22a117356899/24599/intellij-profiler8.webp 238w,
/blog/static/e0ecf7c36a611d1092fe22a117356899/69f92/intellij-profiler8.webp 475w,
/blog/static/e0ecf7c36a611d1092fe22a117356899/cebde/intellij-profiler8.webp 950w,
/blog/static/e0ecf7c36a611d1092fe22a117356899/632a5/intellij-profiler8.webp 1195w"
              sizes="(max-width: 950px) 100vw, 950px"
              type="image/webp"
            />
          <source
            srcset="/blog/static/e0ecf7c36a611d1092fe22a117356899/da2e6/intellij-profiler8.png 238w,
/blog/static/e0ecf7c36a611d1092fe22a117356899/abae4/intellij-profiler8.png 475w,
/blog/static/e0ecf7c36a611d1092fe22a117356899/68327/intellij-profiler8.png 950w,
/blog/static/e0ecf7c36a611d1092fe22a117356899/08158/intellij-profiler8.png 1195w"
            sizes="(max-width: 950px) 100vw, 950px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/blog/static/e0ecf7c36a611d1092fe22a117356899/68327/intellij-profiler8.png"
            alt="intellij-profile8"
            title="intellij-profile8"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span>
메소드별 걸린 시간을 표현(한번 메소드 이름으로 정렬하였다)</p>
<p>이런식으로 두가지 방법(<code class="language-text">synchronized</code>, <code class="language-text">LongAdder</code>)을 그래프, call tree, 메소드별 걸린 시간을 구간구간 확인하여 개선 포인트를 찾는게 훨씬 쉬워진다.</p>
<hr>
<p><code class="language-text">IntelliJ Profiler</code>를 사용해서 대표적으로 <code class="language-text">cpu 사용시간</code>/<code class="language-text">total time</code>을 프로파일링하여 하나씩 확인하였다.</p>
<p>하지만 실제 운영 환경에서 고려해야 할 점은 사실 서버는 cpu를 많이 안쓴다는 점이다. 설명한 예시 두개 다 외부 연동없이 java 코드만 돌리는 것이라 <code class="language-text">total time</code>이 <code class="language-text">cpu time</code>과 크게 연관 있지만 서버에선 <code class="language-text">DB</code>, 외부 api, <code class="language-text">redis</code> 등등 요청하고 대기하는 로직이 많아 실제 cpu는 얼마 안쓰는데 걸린시간은 길 수도 있고, 아님 <code class="language-text">GC</code> 오버헤드로 인해 엉뚱한 곳에서 <code class="language-text">total time</code>이 크게 늘어 날 수도 있다.</p>
<blockquote>
<p>서버에서 cpu를 과도하게 많이 사용된다면 먼저 파일처리, GC 퍼포먼스를 의심해보자</p>
</blockquote>
<p>마지막으로 <code class="language-text">Spring</code>을 쓰면 상상 이상으로 <code class="language-text">call stack</code>이 길어 질 수 있는데 어차피 다 자바 코드이고 하나씩 천천히 따라가면 다 똑같으니 괜히 겁먹을 필요는 없다.</p></div></div></div><div class="Post-module--footer--+HBcE"><div class="Meta-module--meta--2uCvT"><p class="Meta-module--date--TTDWL">Published<!-- --> <!-- -->Dec 30, 2025</p></div><div class="Tags-module--tags--GFiVM"><ul class="Tags-module--list--gq5ra"><li class="Tags-module--item--UgFWJ"><a class="Tags-module--link--5O4-1" href="/blog/tag/java/">java</a></li><li class="Tags-module--item--UgFWJ"><a class="Tags-module--link--5O4-1" href="/blog/tag/profiler/">profiler</a></li></ul></div><div class="Author-module--author--HFjbH"><p class="Author-module--bio--CJUED"><a class="Author-module--twitter--kGR0t" href="https://github.com/qweasd147" rel="noopener noreferrer" target="_blank"><strong>Kim joohyung</strong> on Github</a></p></div></div><div class="Post-module--comments--07meJ"></div></div><div class="Layout-module--layout-doc-mask--qkYmG"></div><div class="SideButton-module--sides--sxqRm"><ul class="SideButton-module--sides-buttons--CcMjz SideButton-module--sides-buttons-hide--OdyhS"><li><a class="SideButton-module--sides-button--pA2tl">Up</a></li><li><a class="SideButton-module--sides-button--pA2tl"><svg class="Icon-module--icon--HX2j3" viewBox="0 0 16 16" style="width:2rem;height:auto"><title>arrowLeftShort</title><path d="M12 8a.5.5 0 0 1-.5.5H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5a.5.5 0 0 1 .5.5z"></path></svg></a></li></ul></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/java/java-async-profiler/";window.___webpackCompilationHash="b0ad3f5cb20b8017caa6";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-4f8c4c04526091b1ccaa.js"],"app":["/app-15348d03227d735910fd.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-0f5b8a073afc45a4d929.js"],"component---src-components-custompage-skills-skills-tsx":["/component---src-components-custompage-skills-skills-tsx-97fdc4b7a905ae978e10.js"],"component---src-components-custompage-total-search-total-search-tsx":["/component---src-components-custompage-total-search-total-search-tsx-df4aaf713a67ac36eba5.js"],"component---src-templates-categories-template-categories-template-tsx":["/component---src-templates-categories-template-categories-template-tsx-56a81cb5064530a23b5a.js"],"component---src-templates-category-template-category-template-tsx":["/component---src-templates-category-template-category-template-tsx-284a16fa141b6e040247.js"],"component---src-templates-index-template-index-template-tsx":["/component---src-templates-index-template-index-template-tsx-cadbf1134cccd9712170.js"],"component---src-templates-not-found-template-not-found-template-tsx":["/component---src-templates-not-found-template-not-found-template-tsx-a05c28eb455a9d539b08.js"],"component---src-templates-post-template-post-template-tsx":["/component---src-templates-post-template-post-template-tsx-b5210253965c870a7e20.js"],"component---src-templates-tag-template-tag-template-tsx":["/component---src-templates-tag-template-tag-template-tsx-1bee2a4f186c77fd728f.js"],"component---src-templates-tags-template-tags-template-tsx":["/component---src-templates-tags-template-tags-template-tsx-5415b22ee6795014eb8f.js"]};/*]]>*/</script><script src="/blog/polyfill-4f8c4c04526091b1ccaa.js" nomodule=""></script><script src="/blog/app-15348d03227d735910fd.js" async=""></script><script src="/blog/framework-5aab6d6db7fbdb045164.js" async=""></script><script src="/blog/webpack-runtime-56da672d410a6717c3ab.js" async=""></script></body></html>