<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/blog/styles.38d1493c0b1b73890619.css">html{font-size:100}body{margin:0 0 0 calc(100vw - 100%);color:#222;line-height:1.625;font-size:1rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:2.5rem;line-height:3.25rem;margin-bottom:1.625rem}h1,h2{margin-top:2.4375rem}h2{font-size:1.6875rem;line-height:2.4375rem;margin-bottom:.8125rem}h3{font-size:1.375rem}h3,h4{line-height:1.625rem;margin-top:1.625rem;margin-bottom:.8125rem}h4{font-size:1.2rem}h5,h6{font-size:1rem;line-height:1.625rem;margin-top:4.0625rem;margin-bottom:.8125rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:1.625rem;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#5d93ff;text-decoration:none}a:active,a:focus,a:hover{color:#f7a046}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.625rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.625rem;margin-bottom:1.625rem}blockquote{padding:0;font-style:italic;border-left:5px solid #39f}blockquote>p{padding-left:.9375rem}blockquote>p>code[class*=language-]{overflow-wrap:break-word}figure{display:block;width:100%;height:auto}figcaption{line-height:1.21875rem;margin-top:.40625rem;color:#222;font-size:.875rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.625rem}.float-right{float:right}.float-left{float:left}}body :not(pre)>code.language-text{background-color:rgba(27,31,35,.05);color:#000;max-width:100%;display:inline-block;white-space:inherit}body :not(pre)>code.language-text::-moz-selection{background-color:#d2d8fb}body :not(pre)>code.language-text::selection{background-color:#d2d8fb}body code[class*=language-],body pre[class*=language-]{background-color:#000;color:#dcdcdc}body code[class*=language-] ::-moz-selection,body pre[class*=language-] ::-moz-selection{background-color:#d2d8fb;color:#fff}body code[class*=language-] ::selection,body pre[class*=language-] ::selection{background-color:#d2d8fb;color:#fff}body .token.atrule,body .token.attr-value,body .token.keyword{color:#39f}body .token.punctuation{color:#dcdcdc}table{width:100%;border-top:1px solid #444;border-collapse:collapse}td,th{border-bottom:1px solid #444;padding:.625rem;text-align:center}a{overflow-wrap:break-word}code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.Author-module--author__photo--36xCH{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--2CaTb{font-size:1.125rem;font-weight:600;line-height:1.82813rem;margin:.8125rem 0}.Author-module--author__title-link--Yrism,.Author-module--author__title-link--Yrism:focus,.Author-module--author__title-link--Yrism:hover{color:#222}.Author-module--author__subtitle--cAaEB{color:#888;line-height:1.625rem;margin-bottom:1.625rem}.Icon-module--icon--Gpyvw{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--1rGd1{margin-bottom:1.625rem}.Contacts-module--contacts__list--3OgdW{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--16p9q{padding:0;margin:.25rem;display:flex;align-content:center;align-items:center;justify-content:center;height:2.1875rem;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #ebebeb}.Contacts-module--contacts__list-item-link--2MIDn{border:0;display:flex;color:#222}.Contacts-module--contacts__list-item-link--2MIDn:focus,.Contacts-module--contacts__list-item-link--2MIDn:hover{color:#5d93ff}.Copyright-module--copyright--1ariN{color:#b6b6b6;font-size:.875rem}.Menu-module--menu--Efbin{margin-bottom:1.625rem}.Menu-module--menu__list--31Zeo{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--1lJ6B{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--10Ush{font-size:1rem;color:#222;font-weight:400;border:0}.Menu-module--menu__list-item-link--10Ush:focus,.Menu-module--menu__list-item-link--10Ush:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.Menu-module--menu__list-item-link--active--2CbUO{color:#222;border-bottom:1px solid #222}.SideButton-module--sides--BtKaf{margin-bottom:1.625rem}.SideButton-module--sides-button--1ZBs9{color:#222;background-color:#fff;padding:0;margin:.25rem;display:flex;align-content:center;align-items:center;justify-content:center;height:3.125rem;width:3.125rem;line-height:3.125rem;border-radius:50%;text-align:center;border:1px solid #ebebeb;position:fixed;right:15px;bottom:10px;cursor:pointer;transition:all .5s ease-in-out}.SideButton-module--sides-button--1ZBs9:focus,.SideButton-module--sides-button--1ZBs9:hover{color:#5d93ff}.SideButton-module--sides-button-hide--1UbTc{bottom:-120px!important}@media screen and (min-width:960px){.SideButton-module--sides-button--1ZBs9{right:10px;bottom:100px;right:70px}}.Sidebar-module--sidebar--X4z2p{width:100%}.Sidebar-module--sidebar__inner--Jdc5s{position:relative;padding:1.5625rem 1.25rem 0}@media screen and (min-width:685px){.Sidebar-module--sidebar--X4z2p{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--Jdc5s:after{background:#e6e6e6;background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:33.75rem;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--X4z2p{width:calc(24.975% - 1.40625rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(4n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(4n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:2.5rem}}.Layout-module--layout--3Pyz6{max-width:75rem;margin-left:auto;margin-right:auto;position:relative}.Layout-module--layout--3Pyz6:before{content:"";display:table}.Layout-module--layout--3Pyz6:after{content:"";display:table;clear:both}.Layout-module--layout-doc-mask--1C0nh{height:30%;top:70%;position:absolute}.Feed-module--feed__item--2D5rE{margin-bottom:2.03125rem}.Feed-module--feed__item--2D5rE:last-child{margin-bottom:.8125rem}.Feed-module--feed__item-title--3nigr{font-size:1.6875rem;line-height:2.4375rem;margin-top:0;margin-bottom:.8125rem}.Feed-module--feed__item-title-link--iFMRs{color:#222}.Feed-module--feed__item-title-link--iFMRs:focus,.Feed-module--feed__item-title-link--iFMRs:hover{color:#222;border-bottom:1px solid #222}.Feed-module--feed__item-description--1uO8e{font-size:1rem;line-height:1.625rem;margin-bottom:1.21875rem}.Feed-module--feed__item-meta-time--3t1fg{font-size:.875rem;color:#222;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-divider--N-Q0A{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--23f8F{font-size:.875rem;color:#f7a046;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--23f8F:focus,.Feed-module--feed__item-meta-category-link--23f8F:hover{color:#5d93ff}.Feed-module--feed__item-readmore--1u6bI{font-size:1rem;color:#5d93ff}.Feed-module--feed__item-readmore--1u6bI:focus,.Feed-module--feed__item-readmore--1u6bI:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.Page-module--page--2nMky{margin-bottom:3.25rem}.Page-module--page__inner--2M_vz{padding:1.5625rem 1.25rem}.Page-module--page__title--GPD8L{font-size:2.5rem;font-weight:600;line-height:3.25rem;margin-top:0;margin-bottom:2.35625rem}.Page-module--page__body--Ic6i6{font-size:1rem;line-height:1.625rem;margin:0 0 1.625rem}@media screen and (min-width:685px){.Page-module--page--2nMky{width:calc(58.275% - .78125rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(12n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(12n+1){clear:both}.Page-module--page__inner--2M_vz{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--2nMky{width:calc(66.6% - .625rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(3n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(3n+1){clear:both}.Page-module--page__inner--2M_vz{padding:2.5rem 2.1875rem}}.Tag-module--tags--BftwU{display:flex;flex-wrap:wrap;grid-gap:11px 20px}.Tag-module--tags__tag--3mcZ8{background:#f1f3f5;border-radius:1.25rem;color:#0ca678;cursor:pointer;display:inline-flex;height:2.1875rem;align-items:center;padding:0 .625rem}.Pagination-module--pagination--2H3nO{margin-top:3.25rem;display:flex}.Pagination-module--pagination__prev--bet5s{width:50%;text-align:left}.Pagination-module--pagination__prev-link--1Nzs6{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--1Nzs6:focus,.Pagination-module--pagination__prev-link--1Nzs6:hover{color:#5d93ff}.Pagination-module--pagination__prev-link--disable--Yklx9{pointer-events:none;color:#bbb}.Pagination-module--pagination__next--3hFiN{width:50%;text-align:right}.Pagination-module--pagination__next-link--3FUtA{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3FUtA:focus,.Pagination-module--pagination__next-link--3FUtA:hover{color:#5d93ff}.Pagination-module--pagination__next-link--disable--30UwZ{pointer-events:none;color:#bbb}.Skills-module--skills-layout__back-button--1Wtuv{cursor:pointer;display:block;max-width:5.625rem;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:1rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.625rem}.Skills-module--skills-layout__back-button--1Wtuv:focus,.Skills-module--skills-layout__back-button--1Wtuv:hover{color:#5d93ff}.Skills-module--skills-layout--4EPsm .Skills-module--skills-wrap--35Dzb{display:grid;grid-column-gap:3px;grid-template-columns:none;grid-row-gap:2px}.Skills-module--skills-layout--4EPsm .Skills-module--skills-wrap--35Dzb .Skills-module--skills--DoUk5{padding-left:1.5625rem;margin-bottom:.9375rem;border-left:1px solid #e1e1e1;display:flex;flex-direction:column;flex-wrap:wrap;align-items:flex-start}.Skills-module--skills-layout--4EPsm .Skills-module--skills-wrap--35Dzb .Skills-module--skills__header--3r4Bx{color:#5d686f;margin-top:.3125rem;display:block}.Skills-module--skills-layout--4EPsm .Skills-module--skills-wrap--35Dzb .Skills-module--skills__container--1Fg-Q{padding-left:2.5rem;padding-top:.5rem}.Skills-module--skills-layout--4EPsm .Skills-module--skills-wrap--35Dzb .Skills-module--skills__container--1Fg-Q ul{padding-left:0;margin-top:0;margin-bottom:.3125rem}.Skills-module--skills-layout--4EPsm .Skills-module--skills-wrap--35Dzb .Skills-module--skills__container--1Fg-Q ul li{margin-top:0;margin-left:1.875rem;margin-bottom:.125rem;list-style-type:disc}.Skills-module--skills-layout--4EPsm .Skills-module--skills-wrap--35Dzb .Skills-module--skills__container--1Fg-Q ul li span{color:#5d686f}.Skills-module--skills-layout--4EPsm .Skills-module--skills-wrap--35Dzb .Skills-module--skills__subtitle--1GDjF{margin:0;color:#5d686f}.Skills-module--skills-layout--4EPsm .Skills-module--skills-wrap--35Dzb .Skills-module--skills__subtitle--1GDjF:not(:first-child){margin-top:0}@media screen and (min-width:960px){.Skills-module--skills-layout__back-button--1Wtuv{position:fixed;max-width:auto;margin:0;top:30px;left:30px}.Skills-module--skills-layout--4EPsm .Skills-module--skills-wrap--35Dzb{grid-template-columns:repeat(3,1fr)}}.Content-module--content--2fUDt{max-width:68.75rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--3jCCL{font-size:2rem;max-width:59.375rem;font-weight:600;text-align:center;line-height:2.68125rem;margin:1.625rem auto 0}.Content-module--content__body--16rY1 figure{margin-bottom:1.625rem}.Content-module--content__body--16rY1 figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.625rem 0}.Content-module--content__body--16rY1 figure blockquote p{max-width:59.375rem;font-size:1.6817rem;margin-top:0;margin-bottom:1.625rem;line-height:2.4375rem}.Content-module--content__body--16rY1 a{text-decoration:underline}.Content-module--content__body--16rY1 *{max-width:59.375rem;margin-left:auto;margin-right:auto}.Content-module--content__body--16rY1 img{max-width:100%}@media screen and (min-width:960px){.Content-module--content--2fUDt{padding:0}.Content-module--content__title--3jCCL{font-size:3rem;line-height:3.65625rem;margin-top:3.65625rem;margin-bottom:2.4375rem}.Content-module--content__body--16rY1,.Content-module--content__body--16rY1 p{font-size:1.125rem;line-height:1.82813rem;margin-bottom:1.82813rem}}.Author-module--author--2Yefr{border-top:1px solid #e6e6e6;max-width:59.375rem;padding-top:1.25rem;line-height:1.625rem;margin-top:1.625rem;margin-bottom:3.25rem}.Author-module--author__bio-twitter--n-O9n{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--2Yefr{margin-left:auto;margin-right:auto}}.Content-module--content--3p512{max-width:68.75rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--2BDW9{font-size:2rem;max-width:59.375rem;font-weight:600;text-align:center;line-height:2.68125rem;margin:1.625rem auto 0}.Content-module--content__body--2TrQ- figure{margin-bottom:1.625rem}.Content-module--content__body--2TrQ- figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.625rem 0}.Content-module--content__body--2TrQ- figure blockquote p{max-width:59.375rem;font-size:1.6817rem;margin-top:0;margin-bottom:1.625rem;line-height:2.4375rem}.Content-module--content__body--2TrQ- a{text-decoration:underline}.Content-module--content__body--2TrQ- *{max-width:59.375rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2TrQ- img{max-width:100%}.Content-module--content__body--2TrQ- ul{margin-left:1.25rem;padding-left:.3125rem}.Content-module--content__body--2TrQ- ul ul{margin-left:.3125rem}@media screen and (min-width:960px){.Content-module--content--3p512{padding:0}.Content-module--content__title--2BDW9{font-size:3rem;line-height:3.65625rem;margin-top:3.65625rem;margin-bottom:2.4375rem}.Content-module--content__body--2TrQ-,.Content-module--content__body--2TrQ- p{font-size:1.125rem;line-height:1.82813rem;margin-bottom:1.82813rem}.Content-module--content__body--2TrQ- ul>li>p{margin-bottom:0}.Content-module--content__body--2TrQ- ul{margin-left:auto;padding-left:2.5rem}.Content-module--content__body--2TrQ- ul ul{margin-left:auto}}.Meta-module--meta__date--29eD7{font-style:italic}.Tags-module--tags--1L_ct{margin-bottom:.8125rem}.Tags-module--tags__list--91FqN{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--1M30P{display:inline-block;margin:.625rem .3125rem}.Tags-module--tags__list-item-link--3SL_8{display:inline-block;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.Tags-module--tags__list-item-link--3SL_8:focus,.Tags-module--tags__list-item-link--3SL_8:hover{color:#5d93ff}.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{max-width:59.375rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__back-button--1aOyz{cursor:pointer;display:block;max-width:5.625rem;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:1rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.625rem}.Post-module--post__back-button--1aOyz:focus,.Post-module--post__back-button--1aOyz:hover{color:#5d93ff}@media screen and (min-width:960px){.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{padding:0}.Post-module--post__back-button--1aOyz{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.20.12"/><link rel="alternate" type="application/rss+xml" title="Blog by joohyung" href="/blog/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id="></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', '', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/blog/sitemap.xml"/><link rel="manifest" href="/blog/manifest.webmanifest"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/blog/icons/icon-48x48.png"/><link rel="apple-touch-icon" sizes="72x72" href="/blog/icons/icon-72x72.png"/><link rel="apple-touch-icon" sizes="96x96" href="/blog/icons/icon-96x96.png"/><link rel="apple-touch-icon" sizes="144x144" href="/blog/icons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="192x192" href="/blog/icons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="256x256" href="/blog/icons/icon-256x256.png"/><link rel="apple-touch-icon" sizes="384x384" href="/blog/icons/icon-384x384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/blog/icons/icon-512x512.png"/><title data-react-helmet="true">AWS - Lambda@Edge - 이미지 리사이징 - Blog by joohyung</title><meta data-react-helmet="true" name="description" content="Cloud Front, Lambda를 활용해서 이미지 실시간 리사이징"/><meta data-react-helmet="true" property="og:site_name" content="AWS - Lambda@Edge - 이미지 리사이징 - Blog by joohyung"/><link as="script" rel="preload" href="/blog/webpack-runtime-a630ce88f35a94866344.js"/><link as="script" rel="preload" href="/blog/framework-99708135f20a48422ed8.js"/><link as="script" rel="preload" href="/blog/532a2f07-1d2a7bbc1a68ccd5edd4.js"/><link as="script" rel="preload" href="/blog/app-82ed98f8319edf21b02d.js"/><link as="script" rel="preload" href="/blog/styles-083a06cb5740baaf347d.js"/><link as="script" rel="preload" href="/blog/b85ce96f5d2f4665e19992ddb57b3614f7b5719c-cf5d7dbd0b99d5546fa0.js"/><link as="script" rel="preload" href="/blog/d4f3f45f3b97a996ebac05174393e9dafe15c3a1-4deb2450f60e37cf9a36.js"/><link as="script" rel="preload" href="/blog/component---src-templates-post-template-js-4fe3da645a5c05165643.js"/><link as="fetch" rel="preload" href="/blog/page-data/posts/aws/aws-lambda-edge-resize/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--3Pyz6"><div><a class="Post-module--post__back-button--1aOyz">뒤로가기</a><div><div class="Content-module--content--3p512"><h1 class="Content-module--content__title--2BDW9">AWS - Lambda@Edge - 이미지 리사이징</h1><div class="Content-module--content__body--2TrQ-"><h2 id="lambdaedge-활용한-이미지-리사이징" style="position:relative;"><a href="#lambdaedge-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%A6%AC%EC%82%AC%EC%9D%B4%EC%A7%95" aria-label="lambdaedge 활용한 이미지 리사이징 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lambda@Edge 활용한 이미지 리사이징</h2>
<p>서비스를 운영할 때 이미지 리소스 관리는 귀찮은 일이 많다. 하나의 이미지라도 여러 서비스에서 각각 최적화된 형태의 포맷, 사이즈 등을 적용 시키고 싶을때가 많기 때문이다. 예를들어 하나의 이미지를 pc에서 볼 땐 원본 그대로 표출하고, 모바일에서 볼땐 <code class="language-text">100x100</code> 사이즈로 표출하려고 한다면 이에 따라 이미지를 어떻게 관리 해야할지 고민이 많을수도 있기 떄문이다.</p>
<p>가장 일반적인 방법으로는 사이즈별 or 포맷별로 전부 이미지 파일을 업로드 하는 방법이 있다. 하지만 이러한 방법은 저장공간도 많이 필요하고 더욱 큰 문제는 업로드 할때도 많은 이미지를 일일이 업로드하기엔 엄청 귀찮고 관리포인트도 많이 늘어나게된다.
두번째 방법으로는 <code class="language-text">S3</code>에 파일이 업로드 되면 여러 형태의 이미지가 생성되도록 람다 트리거를 거는 방법도 있다. 하지만 이 방법은 저장공간은 더욱 많이 들고, 이미지도 언제 생성될지 알 수 없다(생성은 빠르긴 하겠지만 그래도 업로드 직후 확인하면 <code class="language-text">404</code>가 뜨는 케이스가 많을 것이라고 생각된다.)</p>
<p>이런 경우 많이 쓰는게 <code class="language-text">Lambda@Edge</code>를 통해 실시간 이미지 리사이징이다.
<code class="language-text">Cloud Front</code>로 이미지 요청이 오면 <code class="language-text">Origin Response</code>를 조작해서 최적화된 형태의 이미지를 생성 후 응답해주면 된다. 이렇게 구성하면 이미지 저장 공간도 많이 절약되고, 각 플랫폼 별로 최적화 된 이미지를 원본 이미지 변경이나 추가 없이 제공해 줄수 있어 매우 유용하다. 이미지를 매번 생성하여 응답하면 응답시간이 너무 길어 질꺼라는 불안감이 생길 수 있지만 최초 응답 시엔 이미지를 생성하여 응답해주니까 응답시간이 약간 길어 질수 있지만 이후엔 똑같은 요청이라면 <code class="language-text">Cloud front</code>에서 이미지가 캐싱되어 응답하므로 응답시간은 훨씬 단축된다.</p>
<hr>
<h2 id="이미지-리사이징-cloud-front에-적용" style="position:relative;"><a href="#%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%A6%AC%EC%82%AC%EC%9D%B4%EC%A7%95-cloud-front%EC%97%90-%EC%A0%81%EC%9A%A9" aria-label="이미지 리사이징 cloud front에 적용 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>이미지 리사이징 Cloud Front에 적용</h2>
<p>사실 이러한 방법은 다른곳에서도 많이 사용하고 있고, 조금만 찾아보면 소스코드도 쉽게 구할 수가 있다. 하지만 뭔가 다 조금씩 아쉬운것들이 많아 조금 더 개선해 보았다. 구현한 소스코드는 <a href="https://github.com/qweasd147/serverless-boilerplate/tree/master/lambda-edge" target="_blank" rel="nofollow noopener noreferrer">이미지 리사이징</a> 여기서 확인이 가능하다.</p>
<h3 id="중요-포인트--개선한-것" style="position:relative;"><a href="#%EC%A4%91%EC%9A%94-%ED%8F%AC%EC%9D%B8%ED%8A%B8--%EA%B0%9C%EC%84%A0%ED%95%9C-%EA%B2%83" aria-label="중요 포인트  개선한 것 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>중요 포인트 &#x26; 개선한 것</h3>
<ol>
<li><code class="language-text">AWS IAM</code> 생성 및 관리를 <code class="language-text">serverless framework</code>로 옮겨 관리를 쉽게 할 수 있도록 변경. <code class="language-text">aws</code>를 해본 사람이라면 이거 코드로 관리하는게 얼마나 유용한 지 알 것이라 생각된다.</li>
<li>역시 <code class="language-text">serverless framework</code>를 써서 배포를 매우 간단하게 바꿧다.</li>
<li>환경변수 관리를 파일(<code class="language-text">config.js</code>) 및 <code class="language-text">header</code>값을 통해 관리 가능하도록 개선. 기본적으로 <code class="language-text">Lambda@Edge</code>는 환경변수를 사용 못해 <code class="language-text">빌드 환경</code> or <code class="language-text">헤더값</code>을 통해서만 설정값을 사용 할 수가 있다.</li>
<li>만든 소스는 <code class="language-text">Lambda@Edge</code>를 제외한 <code class="language-text">cloud front</code> 및 연관 <code class="language-text">behaviors</code>가 셋팅 된 상태에서 적용 시키는게 목적으로, 기본적인 <code class="language-text">CDN</code> 기능에서 이미지 리사이징 기능을 추가한 일종의 데코레이터라고 생각하며 만들었다(<code class="language-text">CF</code> &#x26; <code class="language-text">behaviors</code>세부 셋팅 및 초기화는 <code class="language-text">Cloud formation</code>으로 관리하지 않는다).</li>
</ol>
<h3 id="적용-방법mac-환경-기준" style="position:relative;"><a href="#%EC%A0%81%EC%9A%A9-%EB%B0%A9%EB%B2%95mac-%ED%99%98%EA%B2%BD-%EA%B8%B0%EC%A4%80" aria-label="적용 방법mac 환경 기준 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>적용 방법(mac 환경 기준)</h3>
<ol>
<li>S3, Cloud Front &#x26; behaviors 셋팅</li>
</ol>
<p>셋팅 방법은 이전 <a href="/blog/tag/cloudfront/">cloud front 글 리스트</a>를 참고한다. 추가로 s3는 public이 아닌 private하게 구성하는걸 추천하고, <code class="language-text">behaviors</code> 구성 시 <code class="language-text">Query String white list</code>를 <code class="language-text">d w h</code>이렇게 3개 추가해준다(소스 코드상에서 3개의 값만 사용하기 때문에).</p>
<p><strong>주의!</strong></p>
<p><code class="language-text">behaviors</code>의 <code class="language-text">path pattern</code>과 <code class="language-text">S3</code>의 디렉토리 시작은 같은걸로 맞춰준다. 소스 코드에선 <code class="language-text">/images</code>로 똑같이 맞춰져 있다.
ex) <code class="language-text">behaviors</code>의 패턴은 <code class="language-text">/images/*</code>로 셋팅, <code class="language-text">S3</code>는 /images 하위에 이미지 파일 업로드</p>
<ol start="2">
<li>소스코드 다운로드 &#x26; 설정값 변경</li>
</ol>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">$ git clone https://github.com/qweasd147/serverless-boilerplate.git
$ cd ./lambda-edge
$ npm install</code></pre></div>
<p>다운 받은 파일에서 <code class="language-text">config.js</code>파일을 수정한다.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">  development<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token constant">BUCKET_NAME</span><span class="token operator">:</span> <span class="token string">"버킷명"</span><span class="token punctuation">,</span>
    <span class="token constant">BUCKET_REGION</span><span class="token operator">:</span> <span class="token string">"ap-northeast-2"</span><span class="token punctuation">,</span> <span class="token comment">//버킷이 있는 리전</span>
    <span class="token constant">BUCKET_PATH</span><span class="token operator">:</span> <span class="token string">"/images/*"</span><span class="token punctuation">,</span> <span class="token comment">//behaviors path, cf->bucket 접근 경로 제한 설정 위해서(role)</span>
    <span class="token constant">DISTRIBUTION_ID</span><span class="token operator">:</span> <span class="token string">"xxxxxxx"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre></div>
<p>위에 값을 바꿔준다. 참고 사항으로 <code class="language-text">development</code>라는 키는 <code class="language-text">stage</code>를 정의하는 값이다. 만약 다른 <code class="language-text">stage</code>도 추가하고 싶으면 키값 &#x26; 설정값을 적당히 변경 및 추가 한 후, <code class="language-text">Cloud Front</code> -> <code class="language-text">Origins</code>으로 접근 한 다음 <code class="language-text">Origin Custom Headers</code>값에 <code class="language-text">x-lambda-stage</code> : stage 값을 추가 해주고, 배포 시 해당 <code class="language-text">stage</code>로 셋팅해서 배포 하면 된다.</p>
<ol start="3">
<li>배포</li>
</ol>
<h4 id="stagedevelopment-변경-없이-그냥-배포" style="position:relative;"><a href="#stagedevelopment-%EB%B3%80%EA%B2%BD-%EC%97%86%EC%9D%B4-%EA%B7%B8%EB%83%A5-%EB%B0%B0%ED%8F%AC" aria-label="stagedevelopment 변경 없이 그냥 배포 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>stage(<code class="language-text">development</code>) 변경 없이 그냥 배포</h4>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">$ npm deploy.dev</code></pre></div>
<h4 id="stagedevelopment-변경-했을-시-sls-문법-그대로-써서-배포" style="position:relative;"><a href="#stagedevelopment-%EB%B3%80%EA%B2%BD-%ED%96%88%EC%9D%84-%EC%8B%9C-sls-%EB%AC%B8%EB%B2%95-%EA%B7%B8%EB%8C%80%EB%A1%9C-%EC%8D%A8%EC%84%9C-%EB%B0%B0%ED%8F%AC" aria-label="stagedevelopment 변경 했을 시 sls 문법 그대로 써서 배포 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>stage(<code class="language-text">development</code>) 변경 했을 시, sls 문법 그대로 써서 배포</h4>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">$ sls deploy --stage 셋팅한_stage_값</code></pre></div>
<p>ex) production 환경 셋팅</p>
<p>config.js</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">  development<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token constant">BUCKET_NAME</span><span class="token operator">:</span> <span class="token string">"버킷명"</span><span class="token punctuation">,</span>
    <span class="token constant">BUCKET_REGION</span><span class="token operator">:</span> <span class="token string">"ap-northeast-2"</span><span class="token punctuation">,</span> <span class="token comment">//버킷이 있는 리전</span>
    <span class="token constant">BUCKET_PATH</span><span class="token operator">:</span> <span class="token string">"/images/*"</span><span class="token punctuation">,</span> <span class="token comment">//behaviors path, cf->bucket 접근 경로 제한 설정 위해서(role)</span>
    <span class="token constant">DISTRIBUTION_ID</span><span class="token operator">:</span> <span class="token string">"xxxxxxx"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  production<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token constant">BUCKET_NAME</span><span class="token operator">:</span> <span class="token string">"product-bucket"</span><span class="token punctuation">,</span>
    <span class="token constant">BUCKET_REGION</span><span class="token operator">:</span> <span class="token string">"ap-northeast-2"</span><span class="token punctuation">,</span>
    <span class="token constant">BUCKET_PATH</span><span class="token operator">:</span> <span class="token string">"/images/*"</span><span class="token punctuation">,</span>
    <span class="token constant">DISTRIBUTION_ID</span><span class="token operator">:</span> <span class="token string">"PRODUCT_CF_ID"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span></code></pre></div>
<p>deploy command</p>
<div class="gatsby-highlight" data-language="sh"><pre class="language-sh"><code class="language-sh">$ sls deploy --stage production</code></pre></div>
<p>추가로 <code class="language-text">x-lambda-stage</code>값 <code class="language-text">production</code> 추가</p>
<h3 id="주의점--커스텀-요소" style="position:relative;"><a href="#%EC%A3%BC%EC%9D%98%EC%A0%90--%EC%BB%A4%EC%8A%A4%ED%85%80-%EC%9A%94%EC%86%8C" aria-label="주의점  커스텀 요소 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>주의점 &#x26; 커스텀 요소</h3>
<ol>
<li>삭제 어려움</li>
</ol>
<p>먼저 배포는 쉬운데 <code class="language-text">Lambda@Edge</code> 적용을 취소하는게 어렵다. 보통 배포 된 것을 취소 하려면 <code class="language-text">Serverless framework</code>에서 제공해주는 <code class="language-text">sls remove</code> 명령을 통해 쉽게 없앨 수가 있지만 <code class="language-text">Lambda@Edge</code> 특성 상 각 리전별로 함수 복제가 일어난다. 이러한 복제된 함수를 먼저 다 없어진 다음에야 버지니아 북부 리전에 배포된 함수 삭제가 가능한데, 복제된 함수가 언제 삭제 될 지는 알수 없다(상황에 따라 많이 다르지만 보통 10분 ~ 30분). 차라리 다시 업데이트 하는거면 일단 배포 한 뒤 적용 되기까지 그냥 무작정 기다릴 수도 있지만 없애는건 아무래도 개발자가 직접 개입해서 <code class="language-text">cloud front</code>에서 연동된 람다 함수를 끊고 복제된 함수가 전부 없어지면 <code class="language-text">cloud formation</code>에서 직접 삭제해야 할 듯 싶다.</p>
<ol start="2">
<li>에러 발생 시 처리 방법</li>
</ol>
<p>올려놓은 소스에선 에러 발생 시, 그냥 에러를 리턴하게 해놓았다. 만약 에러 발생 시 원본 이미지를 그대로 전달해주고 싶으면 약간의 수정이 필요하다.</p>
<p>또한 <code class="language-text">Lambda@Edge</code> 특성상 <code class="language-text">body</code>를 수정하면 <code class="language-text">body</code>에 최대 1MB까지 담을 수 있다. 만약 리사이징 한 이미지가 1MB가 넘는다면 문제가 생기는데 이거 또한 고민이 필요하다. <a href="https://medium.com/daangn/lambda-edge%EB%A1%9C-%EA%B5%AC%ED%98%84%ED%95%98%EB%8A%94-on-the-fly-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%A6%AC%EC%82%AC%EC%9D%B4%EC%A7%95-f4e5052d49f3" target="_blank" rel="nofollow noopener noreferrer">당근 마켓에서 하는 이미지 리사이징</a>을 참고하면 1MB가 넘으면 퀄리티를 조금씩 내리면서 계속 이미지 생성을 하고 있다. 이것도 하나의 방법이긴 하지만 사용하는 곳에 따라 약간의 커스터 마이징이 필요할까 같다.</p>
<ol start="3">
<li>배포 환경에 따라 스크립트 수정</li>
</ol>
<p>먼저 간단하게 serverless에서 내부적으로 하는 배포 과정</p>
<ul>
<li>로컬에서 build (<code class="language-text">npm install</code> 및 <code class="language-text">webpack</code>설정이 있으면 번들링)</li>
<li>cloud formation에 따라 배포</li>
</ul>
<p>현재 소스에서 이미지 리사이징 하는데 사용하는 <code class="language-text">sharp</code>모듈은 os에 따라 내부적으로 설치되는게 다른데 위의 설명한대로 빌드는 로컬 환경에서, 실행은 컨테이너(아마도 리눅스) 환경에서 실행 되다 보니 os 차이가 발생 되어 오류가 발생된다. 이러한 문제를 해결하려면 빌드 환경을 실행하는 환경과 동일하게 구성하거나 아니면 강제로 특정 os에 맞게 모듈을 설치해야한다. 코드 상에서도 강제로 람다 환경에 필요한 모듈을 설치하도록 셋팅 되어 있는데, os에 따라 람다에 맞는 모듈을 설치하려면 <a href="https://sharp.pixelplumbing.com/install#aws-lambda" target="_blank" rel="nofollow noopener noreferrer">sharp install</a>을 참고하면 된다. 참고로 소스 상에서 이러한 문제는 <code class="language-text">npm install</code>하면 자동으로 인스톨 이후에 실행되는 <code class="language-text">postinstall</code>을 사용해서 해결하였다.</p>
<p>package.json</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"postinstall"</span><span class="token operator">:</span> <span class="token string">"rm -rf node_modules/sharp &amp;&amp; SHARP_IGNORE_GLOBAL_LIBVIPS=1 npm install --arch=x64 --platform=linux sharp"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre></div>
<p>위에 내용은 설명한대로 mac 환경에서 셋팅한 <code class="language-text">package.json</code>파일이다. 만약 mac이 아니라면 위 스크립트 내용 수정이 필요하다.</p></div></div></div><div class="Post-module--post__footer--3WzWU"><div><p class="Meta-module--meta__date--29eD7">Published <!-- -->2021-01-22</p></div><div class="Tags-module--tags--1L_ct"><ul class="Tags-module--tags__list--91FqN"><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/blog/tag/aws/">aws</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/blog/tag/cloudfront/">cloudfront</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/blog/tag/cdn/">cdn</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/blog/tag/lambda/">lambda</a></li></ul></div><div class="Author-module--author--2Yefr"><p><a class="Author-module--author__bio-twitter--n-O9n" href="https://github.com/qweasd147" rel="noopener noreferrer" target="_blank"><strong>Kim joohyung</strong> on Github</a></p></div></div><div class="Post-module--post__comments--25y6I"></div></div><div class="Layout-module--layout-doc-mask--1C0nh"></div><div class="SideButton-module--sides--BtKaf"><a class="SideButton-module--sides-button--1ZBs9 SideButton-module--sides-button-hide--1UbTc">Up</a></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/aws/aws-lambda-edge-resize/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-82ed98f8319edf21b02d.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-fe3bb41d5112e8efbcdb.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-51378f8c163528582082.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-7f09502197a745fb2aea.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-c284e1532732377ecf23.js"],"component---src-templates-custom-skills-template-js":["/component---src-templates-custom-skills-template-js-6e1653b5e8042324fafe.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-270a650ea9cf9e2562f0.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-4fe3da645a5c05165643.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-318fb5fa7e0888471404.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-ba13ae9f7e97d2353768.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-619a2418c919c20a95dc.js"]};/*]]>*/</script><script src="/blog/component---src-templates-post-template-js-4fe3da645a5c05165643.js" async=""></script><script src="/blog/d4f3f45f3b97a996ebac05174393e9dafe15c3a1-4deb2450f60e37cf9a36.js" async=""></script><script src="/blog/b85ce96f5d2f4665e19992ddb57b3614f7b5719c-cf5d7dbd0b99d5546fa0.js" async=""></script><script src="/blog/styles-083a06cb5740baaf347d.js" async=""></script><script src="/blog/app-82ed98f8319edf21b02d.js" async=""></script><script src="/blog/532a2f07-1d2a7bbc1a68ccd5edd4.js" async=""></script><script src="/blog/framework-99708135f20a48422ed8.js" async=""></script><script src="/blog/webpack-runtime-a630ce88f35a94866344.js" async=""></script></body></html>