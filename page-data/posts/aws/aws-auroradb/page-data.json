{"componentChunkName":"component---src-templates-post-template-post-template-tsx","path":"/posts/aws/aws-auroradb/","result":{"data":{"markdownRemark":{"id":"767a6318-9537-5783-931b-73dfbe0c34aa","html":"<p>DB 구축을 주제로 blog를 쓰게 될 줄은 몰랐는데, 여지것 남이 구축 or 구축 된 환경에서만 개발하다가 막연히 어려울 것이 없을 줄 알고 딱히 관심도 없었는데 이번에 막상 구축해보니 생각보다 어렵고 삽질도 많이하게 되어 정리할 겸 쓰게 되었다. 역시 해봐야 깨닫게 되는거 같다(물론 다음에 한다면 훨씬 쉽게 구축이 가능 하리라 생각된다).</p>\n<h2 id=\"사전-준비\" style=\"position:relative;\"><a href=\"#%EC%82%AC%EC%A0%84-%EC%A4%80%EB%B9%84\" aria-label=\"사전 준비 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>사전 준비</h2>\n<ul>\n<li>terraform</li>\n<li>awscli(계정 &#x26; credentials 셋팅 포함)</li>\n<li>aws key pair</li>\n</ul>\n<blockquote>\n<p>key pair는 베스천 서버 구축을 위한 것으로(ec2 접속을 비밀번호가 아닌 ssh로 접속) 셋팅이 안되어 있다면 <a href=\"https://github.com/qweasd147/StudyNote/tree/master/terraform/key_pair\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">여기</a> 를 참고해서 privacy key를 aws에 등록 시켜놓는다.</p>\n</blockquote>\n<h1 id=\"구성\" style=\"position:relative;\"><a href=\"#%EA%B5%AC%EC%84%B1\" aria-label=\"구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>구성</h1>\n<p>실행은 <a href=\"https://github.com/qweasd147/StudyNote/tree/master/terraform/db\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">terraform auroradb(Mysql 8.0)</a>에 다운로드 및 terraform init, apply 순서로 실행 시킨다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ terraform init\n$ terraform apply</code></pre></div>\n<p>최초 계정은 <code class=\"language-text\">admin</code>/<code class=\"language-text\">admin1234!</code> 로 생성 되며 필요에 따라 바꾸던가 <code class=\"language-text\">terraform</code>의 <code class=\"language-text\">random_password</code>를 사용해서 개선하여 사용하는것도 좋은 방법이다.</p>\n<p>프로비저닝이 끝나면 아래와 같은 구조로 클러스터가 만들어지는데\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 585px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/a675385763345267f0f3ba53b67a1a52/51d84/multi-az-db-cluster.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.59663865546219%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACI0lEQVQ4y22TzW7bMAzH84B7xT1BgV53GHoa2gRbt7Ur0iK9tF2SzqutWLb8QYofGiQ56ZqN0MWkfyT1JzV79/7Lh7uXAcUBsyiJcjqi4XCyh94eJJ19XJXPDeRwCEF1goFk8AJekCST4a2x6Oxfl2hQDXag0mEzkgPJ/iOaRGfgY8wY8/DwYIzxJIjEzEz89XN1t7RBhTyjZwDcbNaPj4+IPsKss9zPCEBEwoyePDERDcN4u6yuvpcULfpjyvQxwbKHEb2mvnJ7RL4oiufnbVH8KopCJV47962qr3DWCfawhklYDWFETyyS/uO9YKoKCY6CeY6BfgQ3Ugvce+6Rk+ABvWdOUrM6YAfcYYwOgCLqOcGqARA74LJB21GPrCGOFyMd5RTRZqAXC7an0Yv3XjRMsGgAwBDk5np3/qnkyL7CuV0mXZyXV99MCAxwgCleDxGbxv58qm5+FI11QXWCiaMiAFVl7u9/X1+tra1F5FBZUmUoiqKsqpdkcTgRxgyPI1TGGLOrbb2zlg8wcrw6ybQ3SCI6qQ3okSgqmtabOI8jYsSKnEYlU0ysbU1d72rbtm55e/e03qqGnKUsTW0b57rDm3mz26raNo1tbNd1I4C1drPZONemwaJzrbV133d/r/fxw8gmIs51Z2dnFxcXfd/r8aP4H6x7W6/Xq9VqsVjM5/PlcrndbnPGoyz/r3x5eXlyclJVVV3Xp6en8/k8pz6q/AeyLBMgGwpSdgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/blog/static/a675385763345267f0f3ba53b67a1a52/24599/multi-az-db-cluster.webp 238w,\n/blog/static/a675385763345267f0f3ba53b67a1a52/69f92/multi-az-db-cluster.webp 475w,\n/blog/static/a675385763345267f0f3ba53b67a1a52/b1df6/multi-az-db-cluster.webp 585w\"\n              sizes=\"(max-width: 585px) 100vw, 585px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/blog/static/a675385763345267f0f3ba53b67a1a52/da2e6/multi-az-db-cluster.png 238w,\n/blog/static/a675385763345267f0f3ba53b67a1a52/abae4/multi-az-db-cluster.png 475w,\n/blog/static/a675385763345267f0f3ba53b67a1a52/51d84/multi-az-db-cluster.png 585w\"\n            sizes=\"(max-width: 585px) 100vw, 585px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/blog/static/a675385763345267f0f3ba53b67a1a52/51d84/multi-az-db-cluster.png\"\n            alt=\"multi-az-cluster\"\n            title=\"multi-az-cluster\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>대표적으로 하나의 <code class=\"language-text\">Writer DB Instance</code>와 여러 <code class=\"language-text\">Reader DB Instance</code>가 각자 다른 <code class=\"language-text\">AZ</code>에 구축이 된다. 이는 <code class=\"language-text\">subnet group</code>에 영향을 받는 점 참고 하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">resource \"aws_db_subnet_group\" \"db-subnet-group\" {\n  name        = \"db-pri-subnet-group\"\n  subnet_ids  = var.pri-subnets-id\n  description = \"Private DB Subnet Group\"\n}</code></pre></div>\n<p>이런식으로 여러 서브넷을 그룹으로 묶은 다음, <code class=\"language-text\">cluster</code>에 지정하면 알아서 Mutli AZ 구성이 끝나게 된다.</p>\n<blockquote>\n<p>물론 subnet들의 az는 여러개로 구성되게 만들고, private subnet에 구성 하는걸 추천한다.</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 950px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/498873270e5600b86269e66e65d25970/7383e/aws-cluster.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.067226890756302%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAvUlEQVQY0z2OW27EMAhFs/HurQvoHvrRj8k8lMTGBmN7dCojtUiIy+vAdn88UDXUDHentfYfm3to987onWrOkYSUUuysvpnyuiry88Xx+cF2u+0cx0kpFSkFs4ZICeDKly9tZrTm1Kr0Ba8VEWGMTlVFJFPyyZa1cRRnzDfFBPUaw7YgrXGlRB8jamOM8DlnxAUOHfkMxqY++X5VxhuSHSS74sN1fX217/dYfD5fqCreOzlnlhUpnOfFn63+L1iLNX1aKFIMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/blog/static/498873270e5600b86269e66e65d25970/24599/aws-cluster.webp 238w,\n/blog/static/498873270e5600b86269e66e65d25970/69f92/aws-cluster.webp 475w,\n/blog/static/498873270e5600b86269e66e65d25970/cebde/aws-cluster.webp 950w,\n/blog/static/498873270e5600b86269e66e65d25970/ab1e2/aws-cluster.webp 1425w,\n/blog/static/498873270e5600b86269e66e65d25970/33007/aws-cluster.webp 1535w\"\n              sizes=\"(max-width: 950px) 100vw, 950px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/blog/static/498873270e5600b86269e66e65d25970/da2e6/aws-cluster.png 238w,\n/blog/static/498873270e5600b86269e66e65d25970/abae4/aws-cluster.png 475w,\n/blog/static/498873270e5600b86269e66e65d25970/68327/aws-cluster.png 950w,\n/blog/static/498873270e5600b86269e66e65d25970/fe5a5/aws-cluster.png 1425w,\n/blog/static/498873270e5600b86269e66e65d25970/7383e/aws-cluster.png 1535w\"\n            sizes=\"(max-width: 950px) 100vw, 950px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/blog/static/498873270e5600b86269e66e65d25970/68327/aws-cluster.png\"\n            alt=\"aws-az-cluster\"\n            title=\"aws-az-cluster\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n비용 문제로 <code class=\"language-text\">instance2</code>는 코드 상에 주석 처리 되어 있는데 주석을 풀고 배포하면 위와 같이 2개의 인스턴스가 각자 다른 AZ에 Writer/Reader로 구분되어 배포되는것을 확인 할 수 있다.</p>\n<blockquote>\n<p>인스턴스를 늘리면 나머지 AZ에 자동으로 할당 되고, 반대로 인스턴스를 하나로 줄이면 한대로 하나의 인스턴스가 reader, writer 역할을 다 하게 된다. 하나의 인스턴스로 구성 할 경우, 이때 생성 된 <code class=\"language-text\">reader-endpoint</code>로도 쓰기 작업이 가능했던걸로 기억하고 있다.</p>\n</blockquote>\n<p>이런 DB cluster에 외부에서 접근 할 수 있게 <code class=\"language-text\">public subnet</code>에 베스천 서버(ec2)를 올리고 elastic ip를 꽂아 터널링하여 접근하는 방식이다.</p>\n<h2 id=\"주요-옵션-설명\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9A%94-%EC%98%B5%EC%85%98-%EC%84%A4%EB%AA%85\" aria-label=\"주요 옵션 설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>주요 옵션 설명</h2>\n<h3 id=\"cluster-버전-및-인스턴스-타입\" style=\"position:relative;\"><a href=\"#cluster-%EB%B2%84%EC%A0%84-%EB%B0%8F-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4-%ED%83%80%EC%9E%85\" aria-label=\"cluster 버전 및 인스턴스 타입 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cluster 버전 및 인스턴스 타입</h3>\n<p>서브넷 그룹은 위에서 <code class=\"language-text\">다중 AZ</code>를 구성하면서 설명했으니 넘어가고 서버 인스턴스 타입은 <code class=\"language-text\">db.t3.medium</code>로 구성하였는데, 제약사항이 존재하다. 해당 db는 테스트 용도니까 당연히 <code class=\"language-text\">micro</code>나 <code class=\"language-text\">small</code>로 구성하고 싶었지만 엔진 버전이 3이상 쓸려면 <code class=\"language-text\">medium</code> 버전을 써야만 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 950px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/a2136967efb0dedc519d460f915dc021/ca019/db-support-type.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.504201680672269%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAcklEQVQI102MSwoCMRBE5/4H8Caew507V6Mxf9Ah3ZJMfAMNggUPalGvlk0+PMubse+IKjkXUs54H1BVfplzGmMM24QY8SGQUrIeYzJvybcL1/MJ2V40ER7O4ZxjXe+EECmlUGu1sy/QezextWaIyB/KATXtmEuAUY4QAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/blog/static/a2136967efb0dedc519d460f915dc021/24599/db-support-type.webp 238w,\n/blog/static/a2136967efb0dedc519d460f915dc021/69f92/db-support-type.webp 475w,\n/blog/static/a2136967efb0dedc519d460f915dc021/cebde/db-support-type.webp 950w,\n/blog/static/a2136967efb0dedc519d460f915dc021/6606d/db-support-type.webp 1070w\"\n              sizes=\"(max-width: 950px) 100vw, 950px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/blog/static/a2136967efb0dedc519d460f915dc021/da2e6/db-support-type.png 238w,\n/blog/static/a2136967efb0dedc519d460f915dc021/abae4/db-support-type.png 475w,\n/blog/static/a2136967efb0dedc519d460f915dc021/68327/db-support-type.png 950w,\n/blog/static/a2136967efb0dedc519d460f915dc021/ca019/db-support-type.png 1070w\"\n            sizes=\"(max-width: 950px) 100vw, 950px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/blog/static/a2136967efb0dedc519d460f915dc021/68327/db-support-type.png\"\n            alt=\"aws-az-cluster\"\n            title=\"aws-az-cluster\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><a href=\"https://docs.aws.amazon.com/ko_kr/AmazonRDS/latest/AuroraUserGuide/Concepts.DBInstanceClass.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">인스턴스 클래스별 지원 버전</a></p>\n<p><a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/AuroraMySQLReleaseNotes/AuroraMySQL.Updates.30Updates.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">mysql 버전 및 auroradb 버전 정보</a></p>\n<blockquote>\n<p>첫번째 링크에서 <code class=\"language-text\">DB 인스턴스 클래스에 지원되는 DB 엔진</code>에서 확인 가능하고, 엔진 버전이 2를 쓰면 small도 사용가능하지만 구지 이전 버전을 테스트 용도라도 별로 쓰고 싶진 않았다. 근데 <code class=\"language-text\">db.t3.medium</code> 타입은 performance insight를 사용 못하니깐 현업에서 실제로 구축 해야한다면 더 높은 타입을 써야한다.</p>\n</blockquote>\n<h3 id=\"cluster-parameter-group\" style=\"position:relative;\"><a href=\"#cluster-parameter-group\" aria-label=\"cluster parameter group permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cluster parameter group</h3>\n<p><code class=\"language-text\">parameger group</code>은 <code class=\"language-text\">cluster</code>에 적용 할수도 있고, <code class=\"language-text\">cluster</code>의 <code class=\"language-text\">instance</code>에 적용 할 수 있다. 일단 <code class=\"language-text\">cluster</code>의 파라미터만 지정하였고, 일반적으로 자주 사용되고 언급되는 옵션은 아래와 같다</p>\n<ul>\n<li><code class=\"language-text\">time_zone</code> -> DB time zone 지정.</li>\n<li><code class=\"language-text\">long_query_time</code> -> slow query 기준 시간(단위 초)</li>\n<li><code class=\"language-text\">slow_query_log</code> -> slow query를 log로 남길지 여부(0 비활성화, 1 활성화)</li>\n<li><code class=\"language-text\">performance_schema</code> -> performance schema 활성화 여부. 활성화 하면 성능저하가 조금 있다</li>\n<li><code class=\"language-text\">innodb_print_all_deadlocks</code> -> dead lock 쿼리를 error log로 남길지 여부</li>\n</ul>\n<p>개인적으론 위 옵션을 다 활성화 하는게 좋다고 생각되고 <code class=\"language-text\">performance_schema</code>는 조금 고민해 볼 필요가 있다고 생각된다.</p>\n<h3 id=\"slow-query\" style=\"position:relative;\"><a href=\"#slow-query\" aria-label=\"slow query permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>slow query</h3>\n<p><code class=\"language-text\">long_query_time</code>와 <code class=\"language-text\">slow_query_log</code>를 지정하면 slow query가 기록 되지만 이건 instance의 로그파일에서나 볼 수 있다. 좀더 범용적으로 보기 위해선 <code class=\"language-text\">cloudwatch</code>로 보내는게 좋고, cluster에 <code class=\"language-text\">enabled_cloudwatch_logs_exports</code>를 설정해야 <code class=\"language-text\">slow query</code> 나 <code class=\"language-text\">error</code> 로그들이 cloudwatch로 전송된다.</p>\n<h3 id=\"performance-insight\" style=\"position:relative;\"><a href=\"#performance-insight\" aria-label=\"performance insight permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Performance insight</h3>\n<p><code class=\"language-text\">performance_insights_enabled</code>이 옵션으로 활성화/비활성화가 가능하고, 이건 무조건 키는게 좋지만 (보존 기간 설정이 7일 까지는 무료) 인스턴스 타입에 따라 지원이 불가능 할 수도 있다. 실제 운영환경에선 성능이 좋은 타입을 선택 할 테니까 무조건 활성화 하고, 추가로 <code class=\"language-text\">향상된 모니터링(Enhanced Monitoring)</code>도 돈이 더 들지만 운영 환경은 활성화 시키는걸 추천한다</p>","fields":{"slug":"/posts/aws/aws-auroradb/","tagSlugs":["/tag/aws/","/tag/db/","/tag/auroradb/"]},"frontmatter":{"date":"2024-08-14T08:11:14.437Z","description":"Terraform으로 aurora DB 구축 및 주요 옵션 설명","tags":["aws","db","auroradb"],"title":"Terraform으로 구축하는 AWS Aurora DB","socialImage":null}}},"pageContext":{"slug":"/posts/aws/aws-auroradb/"}},"staticQueryHashes":["251939775","2839666046","2891173899","401334301"]}