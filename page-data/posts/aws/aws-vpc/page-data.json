{"componentChunkName":"component---src-templates-post-template-post-template-tsx","path":"/posts/aws/aws-vpc/","result":{"data":{"markdownRemark":{"id":"482d4d32-8eb2-5c03-b243-d64bf0a45aa5","html":"<h2 id=\"vpcvirtual-private-cloud\" style=\"position:relative;\"><a href=\"#vpcvirtual-private-cloud\" aria-label=\"vpcvirtual private cloud permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>VPC(virtual private cloud)</h2>\n<ul>\n<li>aws 클라우드에서 논리적으로 격리된 공간</li>\n<li>가상 네트워크 공간이라 생각하면 됨</li>\n</ul>\n<h2 id=\"azavailability-zone\" style=\"position:relative;\"><a href=\"#azavailability-zone\" aria-label=\"azavailability zone permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AZ(availability zone)</h2>\n<ul>\n<li>물리적으로 분리 되어있는 인프라가 모여있는 데이터 센터</li>\n<li>하나의 리전은 2개 이상의 AZ이 구성되어 있음</li>\n</ul>\n<h2 id=\"subnet\" style=\"position:relative;\"><a href=\"#subnet\" aria-label=\"subnet permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Subnet</h2>\n<ul>\n<li>VPC 하위 단위(부분 집합. 하나의 vpc를 쪼개 놓은 공간이라 생각하면 된다)</li>\n<li>하나의 서브넷은 하나의 AZ에서만 존재 가능</li>\n<li>인터넷을 통한 접근 가능/불가 설정을 할 수 있음(private subnet, public subnet)</li>\n<li>cidr block(사용 할 수 있는 아이피 범위) 적용 가능</li>\n</ul>\n<h2 id=\"internet-gatewayigw\" style=\"position:relative;\"><a href=\"#internet-gatewayigw\" aria-label=\"internet gatewayigw permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Internet Gateway(IGW)</h2>\n<ul>\n<li>인터넷으로 나가는 통로. 이게 없으면 vpc는 외부와 아예 격리되게 된다.</li>\n<li>고가용성이 확보되어 있음</li>\n<li>IGW 로 연결되어 있지 않은 서브넷 = Private Subnet</li>\n<li>Route Table에서 연결 해줘야하</li>\n<li>하나의 vpc에만 연결 가능 (vpc는 하나의 IGW를 갖는다)</li>\n<li>IGW가 없으면 실질적으로 전부 private subnet이 된다고 생각하면 된다(내부에서 인터넷을 못씀).</li>\n</ul>\n<h2 id=\"nacl--security-group\" style=\"position:relative;\"><a href=\"#nacl--security-group\" aria-label=\"nacl  security group permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NACL / Security Group</h2>\n<ul>\n<li>검문소</li>\n<li>NACL => Stateless, SG => Stateful</li>\n<li>기본적으로 VPC 생성 시 만들어줌</li>\n<li>Deny는 NACL 에서만 가능</li>\n</ul>\n<h2 id=\"route-table\" style=\"position:relative;\"><a href=\"#route-table\" aria-label=\"route table permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Route Table</h2>\n<ul>\n<li>트래픽이 어디로 가야할지 알려주는 테이블</li>\n<li>기본적으로 vpc 생성 시 만들어줌</li>\n<li>local에 해당하는 아이피는 말그대로 자기한테서 찾고 그 외의 대역은 다른 igw(or nat gateway)에서 찾도록 셋팅 가능</li>\n</ul>\n<p><code class=\"language-text\">pub &amp; pri subnet</code> 별 Route table 사용 예시를 보자면</p>\n<h4 id=\"public-subnet\" style=\"position:relative;\"><a href=\"#public-subnet\" aria-label=\"public subnet permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>public subnet</h4>\n<table>\n<thead>\n<tr>\n<th>Destination</th>\n<th>Target</th>\n<th>구분</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>10.0.0.0/16</td>\n<td>local</td>\n<td>case 1</td>\n</tr>\n<tr>\n<td>0.0.0.0/0</td>\n<td>igw</td>\n<td>case 2</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"private-subnet\" style=\"position:relative;\"><a href=\"#private-subnet\" aria-label=\"private subnet permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>private subnet</h4>\n<table>\n<thead>\n<tr>\n<th>Destination</th>\n<th>Target</th>\n<th>구분</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>10.0.0.0/16</td>\n<td>local</td>\n<td>(똑같으므로 생략)</td>\n</tr>\n<tr>\n<td>0.0.0.0/0</td>\n<td>nat-gateway</td>\n<td>case 3</td>\n</tr>\n</tbody>\n</table>\n<p>이렇게 <code class=\"language-text\">pub &amp; pri subnet</code> 에 <code class=\"language-text\">route table</code>을 셋팅하였다고 가정</p>\n<p><strong>case 1</strong></p>\n<p><code class=\"language-text\">Destination</code> === <code class=\"language-text\">vpc cidr block</code> vpc 범위 내 있는 내부로 보내는 트래픽이란 뜻으로 내부에서 처리 된다.</p>\n<blockquote>\n<p>이게 있어야 서브넷 끼리 통신이 가능하다.</p>\n</blockquote>\n<h4 id=\"case-2\" style=\"position:relative;\"><a href=\"#case-2\" aria-label=\"case 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>case 2</h4>\n<p><code class=\"language-text\">public subnet</code>내부로 보내는 트래픽이 아닌 그 외 모든 트래픽은 외부로 보내는 트래픽이라는 뜻으로 전부 igw(<code class=\"language-text\">internet gateway</code>)로 보내 외부와 통신이 가능하도록 처리한다. 이게 없으면 내부 subnet에서 이미지나 소스를 다운 받는등의 인터넷 사용이 불가능하다.</p>\n<h4 id=\"case-3\" style=\"position:relative;\"><a href=\"#case-3\" aria-label=\"case 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>case 3</h4>\n<p>public subnet에 리소스(ec2 등)가 있으면 <code class=\"language-text\">public ip</code>도 부여받고 바로 <code class=\"language-text\">igw</code>로 나갈 수 있지만 <code class=\"language-text\">private subnet</code>에 위치하면 바로 <code class=\"language-text\">igw</code>로 빠져 나갈 수가 없다. <code class=\"language-text\">public subnet</code>에 위치한 <code class=\"language-text\">nat-gateway</code>를 통해 <code class=\"language-text\">igw</code>로 나가라고 정의 해놓은 것이다.</p>\n<blockquote>\n<p>이 설정이 없으면 <code class=\"language-text\">private subnet</code>에 위치한 리소스(ec2 등)은 인터넷 사용이 불가능하다. <code class=\"language-text\">nat-gateway</code>를 통해 내부에서 외부 인터넷 접속은 가능해도 외부에선 바로 <code class=\"language-text\">private subnet</code>에 위치한 리소스로 들어올 수는 없다.</p>\n</blockquote>\n<h2 id=\"nat-gateway\" style=\"position:relative;\"><a href=\"#nat-gateway\" aria-label=\"nat gateway permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>NAT Gateway</h2>\n<ul>\n<li>private instance가 외부의 인터넷과 통신하기 위한 통로</li>\n<li>내부 사설망이 있는 private 인스턴스들이 외부 인터넷과 통신을 위해 생성 된 일종의 통로</li>\n<li>하나의 공인 ip 를 가짐</li>\n<li>public subnet에 있어야함</li>\n</ul>\n<p><code class=\"language-text\">route table</code>에서 필요한 설명은 다 했고, 하나의 공인 ip를 가진다고 했는데 public subnet에 위치시켜 <code class=\"language-text\">elastic ip</code>를 부여 받도록 처리 해야한다.</p>\n<blockquote>\n<p>public subnet에 위치하면 언제 바뀔지 모르긴 하지만(ec2 재부팅하면 날라감) public ip를 부여 받지만 private subnet은 그렇지 못하니까 하나의 public ip로 사용된다고 생각하면 된다.</p>\n</blockquote>\n<blockquote>\n<p>public ip를 가져야만 인터넷 통신이 가능하다.</p>\n</blockquote>\n<hr>\n<p>여기까지가 aws에 종속된 서비스. 이 이하는 추가적으로 함께 이해하면 좋은 네트워크 관련 내용</p>\n<h2 id=\"cidrclassless-inter-domain-routing\" style=\"position:relative;\"><a href=\"#cidrclassless-inter-domain-routing\" aria-label=\"cidrclassless inter domain routing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>cidr(Classless Inter Domain Routing)</h2>\n<ul>\n<li>클래스 없이 도메인간 라우팅기법(a,b,c 클래스기반 X). class를 안써서 더 유연한 ip 범위을 갖는다</li>\n<li>private network를 위해 만들어짐(ip가 부족해서 사설망을 구축하기 위해)</li>\n<li>ip주소의 영역을 여러 네트워크 영역으로 나누기 위해 ip를 묶는 방식</li>\n<li>ip 주소에서 네트워크 주소/호스트 주소 구분을 위해 사용된다.</li>\n</ul>\n<p>예를들어 네트워크 대역이 <code class=\"language-text\">192.168.0.0/16</code> 이라치면 앞의 2개(<code class=\"language-text\">192.168</code>)는 네트워크 주소로, 나머지 2개(<code class=\"language-text\">0.0</code>)은 호스트 주소 구분용으로 쓰인다는 의미이다.\n즉, 이 대역의 호스트 개수는 <code class=\"language-text\">192.168.0.0</code> ~ <code class=\"language-text\">192.168.255.255</code> 까지 가능하다(예약된 ip 주소 포함)</p>\n<p>추가로 <code class=\"language-text\">subnet</code> 은 <code class=\"language-text\">vpc</code>의 부분 집합이라 하였는데 <code class=\"language-text\">vpc</code>의 <code class=\"language-text\">cidr block</code> 보다 더 작은 대역을 갖게 된다.\n예를들어 <code class=\"language-text\">vpc</code> 의 <code class=\"language-text\">cidr block</code> 이 <code class=\"language-text\">192.168.0.0/16</code> 이라면 <code class=\"language-text\">subnet</code> <code class=\"language-text\">cidr</code>는 17 이상이 되어야 한다.</p>\n<p>아래 이미지는 vpc의 네트워크 대역과 하위 subnet 대역, subnet에 소속된 기기들의 아이피 주소를 설명하고 있다</p>\n<h3 id=\"private-network사설망\" style=\"position:relative;\"><a href=\"#private-network%EC%82%AC%EC%84%A4%EB%A7%9D\" aria-label=\"private network사설망 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Private Network(사설망)</h3>\n<ul>\n<li>하나의 public ip를 여러 기기가 공유 할 수 있는 방법</li>\n<li>하나의 망에는 private ip를 갖는 기기들과 gateway로 구성됨.</li>\n</ul>\n<p>즉 하나의 사설망 안에 여러 컴퓨터를 셋팅 해놓고 그 컴퓨터 기기에 고유한 private ip(망 안에서만 고유한)를 부여 받도록 구축해놓으면 하나의 public ip를 통해서 여러 컴퓨터가 인터넷을 쓸 수가 있다. 이때, 어느 기기로 트래픽을 보내야할지 라우팅 테이블이 필요하다.</p>","fields":{"slug":"/posts/aws/aws-vpc/","tagSlugs":["/tag/infra/","/tag/aws/","/tag/network/"]},"frontmatter":{"date":"2022-08-25T04:20:10.125Z","description":"AWS 기본적인 네트워크 용어 정리","tags":["infra","aws","network"],"title":"AWS- Network","socialImage":null}}},"pageContext":{"slug":"/posts/aws/aws-vpc/"}},"staticQueryHashes":["251939775","2839666046","2891173899","401334301"]}